<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 htmltools overview | Outstanding User Interfaces with Shiny</title>
<meta name="author" content="David Granjon">
<!-- CSS --><link rel="stylesheet" href="css/style.css">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.2/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.2/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.1.9000/tabs.js"></script><script src="libs/bs3compat-0.2.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Outstanding User Interfaces with Shiny</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="web-intro.html"><span class="header-section-number">1</span> Shiny and the Web</a></li>
<li><a class="" href="web-dependencies.html"><span class="header-section-number">2</span> Discover Shiny dependencies</a></li>
<li class="book-part">Unleash {htmltools}: from R to HTML</li>
<li><a class="active" href="htmltools-overview.html"><span class="header-section-number">3</span> htmltools overview</a></li>
<li><a class="" href="htmltools-dependencies.html"><span class="header-section-number">4</span> Dependency utilities</a></li>
<li><a class="" href="htmltools-other-tools.html"><span class="header-section-number">5</span> Other tools</a></li>
<li class="book-part">Deep dive in the Shiny input system</li>
<li><a class="" href="survival-kit-javascript.html"><span class="header-section-number">6</span> JavaScript for Shiny</a></li>
<li><a class="" href="shiny-intro.html"><span class="header-section-number">7</span> Shiny’s internal: session and websockets</a></li>
<li><a class="" href="shiny-input-system.html"><span class="header-section-number">8</span> Shiny’s input system</a></li>
<li><a class="" href="shiny-input-lifecycle.html"><span class="header-section-number">9</span> Shiny inputs lifecycles</a></li>
<li><a class="" href="shiny-input-gems.html"><span class="header-section-number">10</span> Hidden gems about inputs</a></li>
<li><a class="" href="shiny-custom-handler.html"><span class="header-section-number">11</span> Custom handlers: from R to JavaScript</a></li>
<li class="book-part">Practice 1: a dashboard template</li>
<li><a class="" href="custom-templates-selection.html"><span class="header-section-number">12</span> Template selection</a></li>
<li><a class="" href="custom-templates-dependencies.html"><span class="header-section-number">13</span> Define dependencies</a></li>
<li><a class="" href="custom-templates-skeleton.html"><span class="header-section-number">14</span> Template skeleton</a></li>
<li><a class="" href="custom-templates-testing.html"><span class="header-section-number">15</span> Testing and validating templates elements</a></li>
<li><a class="" href="custom-templates-inputs.html"><span class="header-section-number">16</span> Develop custom input widgets</a></li>
<li><a class="" href="custom-templates-interactivity.html"><span class="header-section-number">17</span> Adding more interactivity</a></li>
<li class="book-part">Toward a better workflow</li>
<li><a class="" href="workflow-charpente.html"><span class="header-section-number">18</span> Introduction to {charpente}</a></li>
<li class="book-part">Beautify with CSS and SASS</li>
<li><a class="" href="beautify-css.html"><span class="header-section-number">19</span> Introduction to CSS</a></li>
<li><a class="" href="beautify-sass.html"><span class="header-section-number">20</span> Introduction to SASS</a></li>
<li><a class="" href="beautify-with-fresh.html"><span class="header-section-number">21</span> Beautify with fresh</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/DivadNojnarg/outstanding-shiny-ui">View book source</a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="htmltools-overview" class="section level1">
<h1>
<span class="header-section-number">3</span> htmltools overview<a class="anchor" aria-label="anchor" href="#htmltools-overview"><i class="fas fa-link"></i></a>
</h1>
<p><code>{htmltools}</code> <span class="citation">(Cheng et al. <a href="references.html#ref-R-htmltools" role="doc-biblioref">2020</a>)</span> is a R package designed to:</p>
<ul>
<li>Generate HTML tags from R</li>
<li>Handle web dependencies (see chapter <a href="htmltools-dependencies.html#htmltools-dependencies">4</a>)</li>
</ul>
<p>Historically, <code>{htmltools}</code> was extracted out of <code>{shiny}</code> <span class="citation">(Chang, Cheng, Allaire, et al. <a href="references.html#ref-R-shiny" role="doc-biblioref">2020</a>)</span> to be able to extend it, that is developing custom HTML tags, importing extra dependencies from the web. That’s why, both packages have many common functions! At the moment, <code>{htmltools}</code> does not have any user guide, although being a key package for all web things!</p>
<div id="writing-html-tags-from-r" class="section level2">
<h2>
<span class="header-section-number">3.1</span> Writing HTML Tags from R<a class="anchor" aria-label="anchor" href="#writing-html-tags-from-r"><i class="fas fa-link"></i></a>
</h2>
<p><code>{htmltools}</code> provides the necessary functions to write HTML tags that were introduced in Chapter <a href="web-intro.html#web-intro-html">1.2</a>. In R, it is even more convenient than raw HTML since their is no opening/closing tag, a simple function call instead:</p>
<div class="sourceCode" id="cb79"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>()
</pre></div>
<div></div>
<p>does produce an HTML <code>&lt;div&gt;&lt;/div&gt;</code> tag. Inside the function call, all named elements will become <code>attributes</code>, whereas unnamed elements will become children. In some cases, tags may have empty attributes like <code>&lt;input disabled&gt;</code>. In that case,
the corresponding R code is <code>input(disabled = NA)</code>.</p>
</div>
<div id="notations" class="section level2">
<h2>
<span class="header-section-number">3.2</span> Notations<a class="anchor" aria-label="anchor" href="#notations"><i class="fas fa-link"></i></a>
</h2>
<p>Whether to use <code>tags$div</code> or <code>div</code> depends if the tag is exported by default.
For instance, you could use <code><a href="https://rdrr.io/pkg/htmltools/man/builder.html">htmltools::div</a></code> but not <code>htmltools::nav</code> since nav does not have a dedicated function (only for <code>p</code>, <code>h1</code>, <code>h2</code>, <code>h3</code>, <code>h4</code>, <code>h5</code>, <code>h6</code>, <code>a</code>, <code>br</code>, <code>div</code>, <code>span</code>, <code>pre</code>, <code>code</code>, <code>img</code>, <code>strong</code>, <code>em</code>, <code>hr</code>).
Rather prefer <code>htmltools::tags$nav</code>. Alternatively, there exists a function (in shiny and htmltools)
called <code>withTags</code>. Wrapping your code in this function allows code like this <code><a href="https://rdrr.io/pkg/htmltools/man/withTags.html">withTags(nav(), ...)</a></code> instead of <code>tags$nav()</code>, thereby omitting the <code>tags$</code> prefixes.
If you had to gather multiple tags together, choose <code><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList()</a></code> over <code><a href="https://rdrr.io/r/base/list.html">list()</a></code>, although the HTML output is the same. The first has the <code>shiny.tag.list</code> class in addition to <code>list</code>. Package like <code>{golem}</code> <span class="citation">(Fay et al. <a href="references.html#ref-R-golem" role="doc-biblioref">2020</a>)</span> (see also <a href="http://golemverse.org" class="uri">http://golemverse.org</a>) allows to test if an R object is a tag list. In this case, using a list would cause the test fail.</p>
</div>
<div id="adding-new-tags" class="section level2">
<h2>
<span class="header-section-number">3.3</span> Adding new tags<a class="anchor" aria-label="anchor" href="#adding-new-tags"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>tag</code> function allows to add extra HTML tags not already defined. You may use it as follows:</p>
<div class="sourceCode" id="cb80"><pre class="downlit">
<span class="kw">customTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tag</a></span>(<span class="st">"test"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(class = <span class="st">"test"</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span>(<span class="st">"Custom Tag"</span>)))
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="kw">customTag</span>)
</pre></div>
<pre><code>## List of 3
##  $ name    : chr "test"
##  $ attribs :List of 1
##   ..$ class: chr "test"
##  $ children:List of 1
##   ..$ :List of 3
##   .. ..$ name    : chr "p"
##   .. ..$ attribs : Named list()
##   .. ..$ children:List of 1
##   .. .. ..$ : chr "Custom Tag"
##   .. ..- attr(*, "class")= chr "shiny.tag"
##  - attr(*, "class")= chr "shiny.tag"</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit">
<span class="kw">customTag</span>
</pre></div>
<test class="test"><p>Custom Tag</p>
</test><p>Good practice is to check whether the created tag is in line with the HTML validation <a href="https://validator.w3.org/">rules</a>.</p>
</div>
<div id="alternative-way-to-write-tags" class="section level2">
<h2>
<span class="header-section-number">3.4</span> Alternative way to write tags<a class="anchor" aria-label="anchor" href="#alternative-way-to-write-tags"><i class="fas fa-link"></i></a>
</h2>
<p><code>{htmltools}</code> comes with the <code><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML()</a></code> function that you can feed with raw HTML:</p>
<div class="sourceCode" id="cb83"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span>(<span class="st">'&lt;div&gt;Blabla&lt;/div&gt;'</span>)
<span class="co"># will render exactly like</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(<span class="st">"Blabla"</span>)

<span class="co"># but there class is different</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span>(<span class="st">'&lt;div&gt;Blabla&lt;/div&gt;'</span>))
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(<span class="st">"Blabla"</span>))
</pre></div>
<p>You will not be able to use tag related functions, as in the following parts.
Therefore, I strongly recommend using R and not mixing HTML in R. Interestingly, if
you want to convert raw HTML to R code, there is a Shiny App developed by Alan
Dipert from RStudio, namely <a href="https://github.com/alandipert/html2r">html2R</a>. There
are some issues, non standard attributes (like <code>data-toggle</code>) are not correctly processed but there are <a href="https://github.com/alandipert/html2r/issues/2">solutions</a>. This will save you precious time! A more recent approach is developed in section <a href="workflow-charpente.html#workflow-charpente">18</a> and has be internally used to develop some of the RinteRface <a href="https://github.com/RinteRface">templates</a>.</p>
<iframe src="https://alandipert.shinyapps.io/html2r/?showcase=0" width="672" height="600px">
</iframe>
</div>
<div id="playing-with-tags" class="section level2">
<h2>
<span class="header-section-number">3.5</span> Playing with tags<a class="anchor" aria-label="anchor" href="#playing-with-tags"><i class="fas fa-link"></i></a>
</h2>
<div id="tags-structure" class="section level3">
<h3>
<span class="header-section-number">3.5.1</span> Tags structure<a class="anchor" aria-label="anchor" href="#tags-structure"><i class="fas fa-link"></i></a>
</h3>
<p>A tag is defined by:</p>
<ul>
<li>A name such as span, div, h1 … <code>tag$name</code>
</li>
<li>Some attributes, which can be accessed with <code>tag$attribs</code>
</li>
<li>Children, which you can be accessed with <code>tag$children</code>
</li>
<li>A class, namely <code>shiny.tag</code>
</li>
</ul>
<p>For instance:</p>
<div class="sourceCode" id="cb84"><pre class="downlit">
<span class="co"># create the tag</span>
<span class="kw">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(
  class = <span class="st">"divclass"</span>, 
  id = <span class="st">"first"</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h1</a></span>(<span class="st">"Here comes your baby"</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(class = <span class="st">"child"</span>, id = <span class="st">"baby"</span>, <span class="st">"Crying"</span>)
)
<span class="co"># access its name</span>
<span class="kw">myTag</span><span class="op">$</span><span class="kw">name</span>
<span class="co"># access its attributes (id and class)</span>
<span class="kw">myTag</span><span class="op">$</span><span class="kw">attribs</span>
<span class="co"># access children (returns a list of 2 elements)</span>
<span class="kw">myTag</span><span class="op">$</span><span class="kw">children</span>
<span class="co"># access its class</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="kw">myTag</span>)
</pre></div>
<p>How to modify the class of the second child?</p>
<div class="sourceCode" id="cb85"><pre class="downlit">
<span class="kw">second_children</span> <span class="op">&lt;-</span> <span class="kw">myTag</span><span class="op">$</span><span class="kw">children</span>[[<span class="fl">2</span>]]
<span class="kw">second_children</span><span class="op">$</span><span class="kw">attribs</span><span class="op">$</span><span class="kw">class</span> <span class="op">&lt;-</span> <span class="st">"adult"</span>
<span class="kw">myTag</span>
<span class="co"># This is not working ...</span>
</pre></div>
<p>Why is this not working? By assigning <code>myTag$children[[2]]</code> to second_children, <code>second_children$attribs$class &lt;- "adult"</code> modifies the class of the copy and not the original object. Thus we do:</p>
<div class="sourceCode" id="cb86"><pre class="downlit">
<span class="kw">myTag</span><span class="op">$</span><span class="kw">children</span>[[<span class="fl">2</span>]]<span class="op">$</span><span class="kw">attribs</span><span class="op">$</span><span class="kw">class</span> <span class="op">&lt;-</span> <span class="st">"adult"</span>
<span class="kw">myTag</span>
</pre></div>
</div>
<div id="useful-functions-for-tags" class="section level3">
<h3>
<span class="header-section-number">3.5.2</span> Useful functions for tags<a class="anchor" aria-label="anchor" href="#useful-functions-for-tags"><i class="fas fa-link"></i></a>
</h3>
<p><code>{htmltools}</code> and <code>{shiny}</code> have powerful functions to seamlessly manipulate tags.</p>
<div id="add-attributes" class="section level4">
<h4>
<span class="header-section-number">3.5.2.1</span> Add attributes<a class="anchor" aria-label="anchor" href="#add-attributes"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>tagAppendAttributes</code>: this function allows to add a new attribute to the current tag.</li>
</ul>
<p>For instance, assuming we created a div without any id attribute:</p>
<div class="sourceCode" id="cb87"><pre class="downlit">
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(<span class="st">"Where is my brain"</span>)
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagAppendAttributes</a></span>(<span class="kw">mydiv</span>, id = <span class="st">"here_it_is"</span>)
</pre></div>
<p>You can pass as many attributes as you want, including non standard attributes such as <code>data-toggle</code> (see Bootstrap 3 <a href="https://www.w3schools.com/bootstrap/bootstrap_ref_js_collapse.asp">tabs</a> for instance):</p>
<div class="sourceCode" id="cb88"><pre class="downlit">
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagAppendAttributes</a></span>(<span class="kw">mydiv</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(`data-toggle` = <span class="st">"tabs"</span>, class = <span class="st">"myclass"</span>))
<span class="co"># even though you could proceed as follows but this requires 2 steps</span>
<span class="kw">mydiv</span><span class="op">$</span><span class="kw">attribs</span>[[<span class="st">"data-toggle"</span>]] <span class="op">&lt;-</span> <span class="st">"tabs"</span>
<span class="kw">mydiv</span><span class="op">$</span><span class="kw">attribs</span><span class="op">$</span><span class="kw">class</span> <span class="op">&lt;-</span> <span class="st">"myclass"</span>
</pre></div>
</div>
<div id="check-if-tag-has-specific-attribute" class="section level4">
<h4>
<span class="header-section-number">3.5.2.2</span> Check if tag has specific attribute<a class="anchor" aria-label="anchor" href="#check-if-tag-has-specific-attribute"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>tagHasAttribute</code>: to check if a tag has a specific attribute</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="downlit">
<span class="co"># I want to know if div has a class</span>
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(class = <span class="st">"myclass"</span>)
<span class="kw">has_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagHasAttribute</a></span>(<span class="kw">mydiv</span>, <span class="st">"class"</span>)
<span class="kw">has_class</span>
<span class="co"># if you are familiar with %&gt;%</span>
<span class="kw">has_class</span> <span class="op">&lt;-</span> <span class="kw">mydiv</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagHasAttribute</a></span>(<span class="st">"class"</span>)
<span class="kw">has_class</span>
</pre></div>
<p>In practice, this function is useful when testing tag elements as shown in chapter <a href="custom-templates-testing.html#custom-templates-testing">15</a>.</p>
</div>
<div id="get-all-attributes" class="section level4">
<h4>
<span class="header-section-number">3.5.2.3</span> Get all attributes<a class="anchor" aria-label="anchor" href="#get-all-attributes"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>tagGetAttribute</code>: to get the value of the targeted attributes, if it exists, otherwise NULL.</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="downlit">
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(class = <span class="st">"test"</span>)
<span class="co"># returns the class</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagGetAttribute</a></span>(<span class="kw">mydiv</span>, <span class="st">"class"</span>)
<span class="co"># returns NULL</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagGetAttribute</a></span>(<span class="kw">mydiv</span>, <span class="st">"id"</span>)
</pre></div>
</div>
<div id="set-childchildren" class="section level4">
<h4>
<span class="header-section-number">3.5.2.4</span> Set child/children<a class="anchor" aria-label="anchor" href="#set-childchildren"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>tagSetChildren</code> allows to create children for a given tag. For instance:</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="downlit">
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(class = <span class="st">"parent"</span>, id = <span class="st">"mother"</span>, <span class="st">"Not the mama!!!"</span>)
<span class="co"># mydiv has 1 child "Not the mama!!!"</span>
<span class="kw">mydiv</span> 
<span class="kw">children</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="kw">span</span>)
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagSetChildren</a></span>(<span class="kw">mydiv</span>, <span class="kw">children</span>)
<span class="co"># mydiv has 3 children, the first one was removed</span>
<span class="kw">mydiv</span> 
</pre></div>
<p>Notice that <code>tagSetChildren</code> removes all existing children. Below we see another set of functions to add children while conserving existing ones.</p>
</div>
<div id="add-child-or-children" class="section level4">
<h4>
<span class="header-section-number">3.5.2.5</span> Add child or children<a class="anchor" aria-label="anchor" href="#add-child-or-children"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>tagAppendChild</code> and <code>tagAppendChildren</code>: add other tags to an existing tag.
Whereas <code>tagAppendChild</code> only takes one tag, you can pass a list of tags to <code>tagAppendChildren</code>.</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="downlit">
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(class = <span class="st">"parent"</span>, id = <span class="st">"mother"</span>, <span class="st">"Not the mama!!!"</span>)
<span class="kw">otherTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="st">"I am your child"</span>)
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagAppendChild</a></span>(<span class="kw">mydiv</span>, <span class="kw">otherTag</span>)
</pre></div>
</div>
<div id="build-your-own-functions" class="section level4">
<h4>
<span class="header-section-number">3.5.2.6</span> Build your own functions<a class="anchor" aria-label="anchor" href="#build-your-own-functions"><i class="fas fa-link"></i></a>
</h4>
<p>You might wonder why there is no <code>tagRemoveChild</code> or <code>tagRemoveAttributes</code>.
Let’s look at the <code>tagAppendChild</code></p>
<div class="sourceCode" id="cb93"><pre class="downlit">
<span class="kw">tagAppendChild</span> <span class="op">&lt;-</span> <span class="fu">function</span> (<span class="kw">tag</span>, <span class="kw">child</span>) {
  <span class="kw">tag</span><span class="op">$</span><span class="kw">children</span>[[<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">tag</span><span class="op">$</span><span class="kw">children</span>) <span class="op">+</span> <span class="fl">1</span>]] <span class="op">&lt;-</span> <span class="kw">child</span>
  <span class="kw">tag</span>
}
</pre></div>
<p>Below we write the <code>tagRemoveChild</code>, where tag is the target and n is the position to remove in the list of children:</p>
<div class="sourceCode" id="cb94"><pre class="downlit">
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(class = <span class="st">"parent"</span>, id = <span class="st">"mother"</span>, <span class="st">"Not the mama!!!"</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="st">"Hey!"</span>))

<span class="co"># we create the tagRemoveChild function</span>
<span class="kw">tagRemoveChild</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">tag</span>, <span class="kw">n</span>) {
  <span class="co"># check if the list is empty</span>
  <span class="co">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">tag</span><span class="op">$</span><span class="kw">children</span>) <span class="op">==</span> <span class="fl">0</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw">tag</span><span class="op">$</span><span class="kw">name</span>, <span class="st">"does not have any children!"</span>))
  }
  <span class="kw">tag</span><span class="op">$</span><span class="kw">children</span>[<span class="kw">n</span>] <span class="op">&lt;-</span> <span class="kw">NULL</span>
  <span class="kw">tag</span>
}
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu">tagRemoveChild</span>(<span class="kw">mydiv</span>, <span class="fl">1</span>)
<span class="kw">mydiv</span>
</pre></div>
<p>When defining the <code>tagRemoveChild</code>, we choose <code><a href="https://rdrr.io/r/base/Extract.html">[</a></code> instead of <code><a href="https://rdrr.io/r/base/Extract.html">[[</a></code> to allow to select multiple list elements:</p>
<div class="sourceCode" id="cb95"><pre class="downlit">
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(class = <span class="st">"parent"</span>, id = <span class="st">"mother"</span>, <span class="st">"Not the mama!!!"</span>, <span class="st">"Hey!"</span>)
<span class="co"># fails</span>
<span class="fu">`[[`</span>(<span class="kw">mydiv</span><span class="op">$</span><span class="kw">children</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="co"># works</span>
<span class="fu">`[`</span>(<span class="kw">mydiv</span><span class="op">$</span><span class="kw">children</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
</pre></div>
<p>Alternatively, we could also create a <code>tagRemoveChildren</code> function. Also notice that the function raises an error if the provided tag does not have children.</p>
<p>The <code>tagAppendChild</code> is not able to insert at a specific position. We could draft the <code>tagInsertChild</code> building on top of the base R <code>append</code> function:</p>
<div class="sourceCode" id="cb96"><pre class="downlit">
<span class="kw">tagInsertChild</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">tag</span>, <span class="kw">child</span>, <span class="kw">position</span>) {
  <span class="kw">tag</span><span class="op">$</span><span class="kw">children</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html">append</a></span>(<span class="kw">tag</span><span class="op">$</span><span class="kw">children</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">child</span>), <span class="kw">position</span> <span class="op">-</span> <span class="fl">1</span>)
  <span class="kw">tag</span>
}

<span class="fu">tagInsertChild</span>(<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="st">"hello"</span>)), <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span>(), <span class="fl">1</span>)
<span class="fu">tagInsertChild</span>(<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="st">"hello"</span>)), <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span>(), <span class="fl">2</span>)
</pre></div>
</div>
</div>
<div id="other-functions" class="section level3">
<h3>
<span class="header-section-number">3.5.3</span> Other functions<a class="anchor" aria-label="anchor" href="#other-functions"><i class="fas fa-link"></i></a>
</h3>
<p>The <a href="https://github.com/ThinkR-open/golem/blob/dev/inst/utils/golem_utils_ui.R">Golem</a> package written by <a href="https://thinkr.fr">thinkr</a> contains neat functions to edit your tags.</p>
<p>Particularly, the <code>tagRemoveAttributes</code>:</p>
<div class="sourceCode" id="cb97"><pre class="downlit">
<span class="kw">tagRemoveAttributes</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">tag</span>, <span class="kw">...</span>) {
  <span class="kw">attrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">...</span>))
  <span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(<span class="kw">attrs</span>)) {
    <span class="kw">tag</span><span class="op">$</span><span class="kw">attribs</span>[[ <span class="kw">attrs</span>[<span class="kw">i</span>] ]] <span class="op">&lt;-</span> <span class="kw">NULL</span>
  }
  <span class="kw">tag</span>
}
</pre></div>
<div class="sourceCode" id="cb98"><pre class="downlit">
<span class="kw">mydiv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(class = <span class="st">"test"</span>, id = <span class="st">"coucou"</span>, <span class="st">"Hello"</span>)
<span class="fu">tagRemoveAttributes</span>(<span class="kw">mydiv</span>, <span class="st">"class"</span>, <span class="st">"id"</span>)
</pre></div>
</div>
<div id="conditionally-set-attributes" class="section level3">
<h3>
<span class="header-section-number">3.5.4</span> Conditionally set attributes<a class="anchor" aria-label="anchor" href="#conditionally-set-attributes"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes, you only want to set attributes under specific conditions.</p>
<div class="sourceCode" id="cb99"><pre class="downlit">
<span class="kw">my_button</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">color</span> = <span class="kw">NULL</span>) {
  <span class="kw">tags</span><span class="op">$</span><span class="fu">button</span>( 
    style = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"color:"</span>, <span class="kw">color</span>),
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span>(<span class="st">"Hello"</span>)
  )
}

<span class="fu">my_button</span>()
</pre></div>
<p>This example will not fail but having <code>style="color: "</code> is not clean. We may use conditions:</p>
<div class="sourceCode" id="cb100"><pre class="downlit">
<span class="kw">my_button</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">color</span> = <span class="kw">NULL</span>) {
  <span class="kw">tags</span><span class="op">$</span><span class="fu">button</span>( 
    style = <span class="co">if</span> (<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(<span class="kw">color</span>)) <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"color:"</span>, <span class="kw">color</span>),
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span>(<span class="st">"Hello"</span>)
  )
}

<span class="fu">my_button</span>(<span class="st">"blue"</span>)
<span class="fu">my_button</span>()
</pre></div>
<p>In this example, style won’t be available if color is not specified.</p>
</div>
<div id="using" class="section level3">
<h3>
<span class="header-section-number">3.5.5</span> Using %&gt;%<a class="anchor" aria-label="anchor" href="#using"><i class="fas fa-link"></i></a>
</h3>
<p>While doing a lot of manipulation for a tag, if you don’t need to create intermediate
objects, this is a good idea to use <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code> from <a href="https://magrittr.tidyverse.org">magrittr</a>:</p>
<div class="sourceCode" id="cb101"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(class = <span class="st">"cl"</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h1</a></span>(<span class="st">"Hello"</span>)) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagAppendAttributes</a></span>(id = <span class="st">"myid"</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagAppendChild</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span>(<span class="st">"some extra text here!"</span>))
</pre></div>
<p>The pipe syntax is overall easier to follow and read.</p>
</div>
<div id="programmatically-create-children-elements" class="section level3">
<h3>
<span class="header-section-number">3.5.6</span> Programmatically create children elements<a class="anchor" aria-label="anchor" href="#programmatically-create-children-elements"><i class="fas fa-link"></i></a>
</h3>
<p>Assume you want to create a tag with three children inside:</p>
<div class="sourceCode" id="cb102"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="fl">1</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="fl">2</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="fl">3</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="fl">4</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="fl">5</span>)
)
</pre></div>
<p>The structure is correct but imagine if you had to create 1000 <code>span</code> or fancier tag. The previous approach is not consistent with DRY programming. <code>lapply</code> function will be useful here (or the purrr <code>map</code> family):</p>
<div class="sourceCode" id="cb103"><pre class="downlit">
<span class="co"># base R</span>
<span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu">function</span>(<span class="kw">i</span>) <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="kw">i</span>)))
<span class="co"># purrr + %&gt;%</span>
<span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html">map</a></span>(<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu">function</span>(<span class="kw">i</span>) <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(<span class="kw">i</span>)) <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>()
</pre></div>
</div>
</div>
<div id="exercises" class="section level2">
<h2>
<span class="header-section-number">3.6</span> Exercises<a class="anchor" aria-label="anchor" href="#exercises"><i class="fas fa-link"></i></a>
</h2>
<div id="exercise-1-tags-structure-5-minutes" class="section level3">
<h3>
<span class="header-section-number">3.6.1</span> Exercise 1: tags structure (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-1-tags-structure-5-minutes"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the following shiny tag:</p>
<div class="sourceCode" id="cb104"><pre class="downlit">
<span class="kw">myTag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a</a></span>(
  class = <span class="st">"btn btn-large"</span>,
  type = <span class="st">"button"</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(class = <span class="st">"child1"</span>, id = <span class="st">"super-span"</span>, <span class="fl">1</span>),
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">span</a></span>(class = <span class="st">"child2"</span>, <span class="fl">2</span>)
)

<span class="kw">myTag</span>
</pre></div>
<ol style="list-style-type: decimal">
<li>Inspect its structure. Hint: you may use <code>str</code>.</li>
<li>Access its class using <code>tagGetAttribute</code> and another method of your choice.</li>
<li>Modify the first child class to <code>custom class</code>.</li>
</ol>
</div>
<div id="exercise-2-modifiying-tags-5-minutes" class="section level3">
<h3>
<span class="header-section-number">3.6.2</span> Exercise 2: modifiying tags (5 minutes)<a class="anchor" aria-label="anchor" href="#exercise-2-modifiying-tags-5-minutes"><i class="fas fa-link"></i></a>
</h3>
<p>Let us consider the following tag:</p>
<div class="sourceCode" id="cb105"><pre class="downlit">
<span class="kw">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span>(<span class="st">"Hello World"</span>)
</pre></div>
<p>(You may chain functions with <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code>)</p>
<ol style="list-style-type: decimal">
<li>Replace its unique child by <code><a href="https://rdrr.io/pkg/htmltools/man/builder.html">a(href = "http://www.google.com", "click me!")</a></code>. Hint: <code>tagSetChildren</code> is your friend.</li>
<li>Add 10 other <code>span</code>. Hint: tags may be programmatically generated with <code>lapply</code> or <code><a href="https://rdrr.io/pkg/purrr/man/map.html">purrr::map</a></code>.</li>
</ol>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="web-dependencies.html"><span class="header-section-number">2</span> Discover Shiny dependencies</a></div>
<div class="next"><a href="htmltools-dependencies.html"><span class="header-section-number">4</span> Dependency utilities</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#htmltools-overview"><span class="header-section-number">3</span> htmltools overview</a></li>
<li><a class="nav-link" href="#writing-html-tags-from-r"><span class="header-section-number">3.1</span> Writing HTML Tags from R</a></li>
<li><a class="nav-link" href="#notations"><span class="header-section-number">3.2</span> Notations</a></li>
<li><a class="nav-link" href="#adding-new-tags"><span class="header-section-number">3.3</span> Adding new tags</a></li>
<li><a class="nav-link" href="#alternative-way-to-write-tags"><span class="header-section-number">3.4</span> Alternative way to write tags</a></li>
<li>
<a class="nav-link" href="#playing-with-tags"><span class="header-section-number">3.5</span> Playing with tags</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#tags-structure"><span class="header-section-number">3.5.1</span> Tags structure</a></li>
<li><a class="nav-link" href="#useful-functions-for-tags"><span class="header-section-number">3.5.2</span> Useful functions for tags</a></li>
<li><a class="nav-link" href="#other-functions"><span class="header-section-number">3.5.3</span> Other functions</a></li>
<li><a class="nav-link" href="#conditionally-set-attributes"><span class="header-section-number">3.5.4</span> Conditionally set attributes</a></li>
<li><a class="nav-link" href="#using"><span class="header-section-number">3.5.5</span> Using %&gt;%</a></li>
<li><a class="nav-link" href="#programmatically-create-children-elements"><span class="header-section-number">3.5.6</span> Programmatically create children elements</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exercises"><span class="header-section-number">3.6</span> Exercises</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exercise-1-tags-structure-5-minutes"><span class="header-section-number">3.6.1</span> Exercise 1: tags structure (5 minutes)</a></li>
<li><a class="nav-link" href="#exercise-2-modifiying-tags-5-minutes"><span class="header-section-number">3.6.2</span> Exercise 2: modifiying tags (5 minutes)</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/blob/master/htmltools-overview.Rmd">View source</a></li>
          <li><a id="book-edit" href="https://github.com/DivadNojnarg/outstanding-shiny-ui/edit/master/htmltools-overview.Rmd">Edit this page</a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Outstanding User Interfaces with Shiny</strong>" was written by David Granjon. It waslast built on 2020-10-31.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This website is produced by the <a class="text-light" href="https://bookdown.org">bookdown</a> bs4_book template.</p>
  </div>

</div></div>
</footer>
</body>
</html>
