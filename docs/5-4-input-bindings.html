<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="5.4 Input bindings | Outstanding User Interfaces with Shiny" />
<meta property="og:type" content="book" />


<meta property="og:description" content="A book about deeply customizing Shiny app for production." />
<meta name="github-repo" content="DivadNojnarg/outstanding-shiny-ui" />

<meta name="author" content="David Granjon" />

<meta name="date" content="2020-08-31" />


<meta name="description" content="A book about deeply customizing Shiny app for production.">

<title>5.4 Input bindings | Outstanding User Interfaces with Shiny</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
p.caption {
  color: #777;
  margin-top: 10px;
}
p code {
  white-space: inherit;
}
pre {
  word-break: normal;
  word-wrap: normal;
}
pre code {
  white-space: inherit;
}
p.flushright {
  text-align: right;
}
blockquote > p:last-child {
  text-align: right;
}
blockquote > p:first-child {
  text-align: inherit;
}

/* Callouts */
.callout {
  border-radius: 0.25rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
  background-color: #ffffff;
  border-left: 5px solid #e9ecef;
  margin-bottom: 1rem;
  padding: 1rem;
}

.callout a {
  color: #495057;
  text-decoration: underline;
}

.callout a:hover {
  color: #e9ecef;
}

.callout p:last-child {
  margin-bottom: 0;
}

.callout.callout-danger {
  border-left-color: #bd2130;
}

.callout.callout-warning {
  border-left-color: #d39e00;
}

.callout.callout-info {
  border-left-color: #117a8b;
}

.callout.callout-success {
  border-left-color: #1e7e34;
}


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#prerequisites">Prerequisites</a><ul>
<li><a href="disclaimer.html#disclaimer">Disclaimer</a></li>
<li><a href="is-this-book-for-me.html#is-this-book-for-me">Is this book for me?</a></li>
<li><a href="related-content.html#related-content">Related content</a></li>
<li><a href="acknowledgements.html#acknowledgements">Acknowledgements</a></li>
<li><a href="packages.html#packages">Packages</a></li>
</ul></li>
<li class="has-sub"><a href="1-intro.html#intro"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="1-1-about-the-code.html#about-the-code"><span class="toc-section-number">1.1</span> About the code</a></li>
<li><a href="1-2-preliminary-exercices.html#preliminary-exercices"><span class="toc-section-number">1.2</span> Preliminary exercices</a></li>
</ul></li>
<li class="part"><span><b>Survival Kit</b></span></li>
<li class="has-sub"><a href="2-survival-kit-html.html#survival-kit-html"><span class="toc-section-number">2</span> HTML</a><ul>
<li><a href="2-1-html-basics.html#html-basics"><span class="toc-section-number">2.1</span> HTML Basics</a></li>
<li><a href="2-2-tag-attributes.html#tag-attributes"><span class="toc-section-number">2.2</span> Tag attributes</a></li>
<li><a href="2-3-html-page-skeleton.html#html-page-skeleton"><span class="toc-section-number">2.3</span> HTML page: skeleton</a></li>
<li class="has-sub"><a href="2-4-about-the-document-object-model-dom.html#about-the-document-object-model-dom"><span class="toc-section-number">2.4</span> About the Document Object Model (DOM)</a><ul>
<li><a href="2-4-about-the-document-object-model-dom.html#visualizing-the-dom-the-html-inspector"><span class="toc-section-number">2.4.1</span> Visualizing the DOM: the HTML inspector</a></li>
</ul></li>
<li class="has-sub"><a href="2-5-preliminary-introduction-to-css-and-javascript.html#preliminary-introduction-to-css-and-javascript"><span class="toc-section-number">2.5</span> Preliminary introduction to CSS and JavaScript</a><ul>
<li><a href="2-5-preliminary-introduction-to-css-and-javascript.html#html-and-css"><span class="toc-section-number">2.5.1</span> HTML and CSS</a></li>
<li><a href="2-5-preliminary-introduction-to-css-and-javascript.html#html-and-javascript"><span class="toc-section-number">2.5.2</span> HTML and JavaScript</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="3-survival-kit-javascript.html#survival-kit-javascript"><span class="toc-section-number">3</span> JavaScript</a><ul>
<li><a href="3-1-introduction.html#introduction"><span class="toc-section-number">3.1</span> Introduction</a></li>
<li class="has-sub"><a href="3-2-setup.html#setup"><span class="toc-section-number">3.2</span> Setup</a><ul>
<li><a href="3-2-setup.html#node"><span class="toc-section-number">3.2.1</span> Node</a></li>
<li><a href="3-2-setup.html#choose-a-good-ide"><span class="toc-section-number">3.2.2</span> Choose a good IDE</a></li>
<li><a href="3-2-setup.html#first-script"><span class="toc-section-number">3.2.3</span> First Script</a></li>
</ul></li>
<li class="has-sub"><a href="3-3-programming-with-js-basis.html#programming-with-js-basis"><span class="toc-section-number">3.3</span> Programming with JS: basis</a><ul>
<li><a href="3-3-programming-with-js-basis.html#js-types"><span class="toc-section-number">3.3.1</span> JS types</a></li>
<li><a href="3-3-programming-with-js-basis.html#variables"><span class="toc-section-number">3.3.2</span> Variables</a></li>
<li><a href="3-3-programming-with-js-basis.html#conditions"><span class="toc-section-number">3.3.3</span> Conditions</a></li>
<li><a href="3-3-programming-with-js-basis.html#objects"><span class="toc-section-number">3.3.4</span> Objects</a></li>
<li><a href="3-3-programming-with-js-basis.html#iterations"><span class="toc-section-number">3.3.5</span> Iterations</a></li>
<li><a href="3-3-programming-with-js-basis.html#functions"><span class="toc-section-number">3.3.6</span> Functions</a></li>
<li><a href="3-3-programming-with-js-basis.html#event-listeners"><span class="toc-section-number">3.3.7</span> Event listeners</a></li>
</ul></li>
<li class="has-sub"><a href="3-4-jquery.html#jquery"><span class="toc-section-number">3.4</span> jQuery</a><ul>
<li><a href="3-4-jquery.html#introduction-1"><span class="toc-section-number">3.4.1</span> Introduction</a></li>
<li><a href="3-4-jquery.html#syntax"><span class="toc-section-number">3.4.2</span> Syntax</a></li>
<li><a href="3-4-jquery.html#useful-functions"><span class="toc-section-number">3.4.3</span> Useful functions</a></li>
<li><a href="3-4-jquery.html#chaining-jquery-methods"><span class="toc-section-number">3.4.4</span> Chaining jQuery methods</a></li>
<li><a href="3-4-jquery.html#iterations-1"><span class="toc-section-number">3.4.5</span> Iterations</a></li>
<li><a href="3-4-jquery.html#good-practice"><span class="toc-section-number">3.4.6</span> Good practice</a></li>
<li><a href="3-4-jquery.html#events"><span class="toc-section-number">3.4.7</span> Events</a></li>
<li><a href="3-4-jquery.html#extending-objects"><span class="toc-section-number">3.4.8</span> Extending objects</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Shiny: What’s under the Hood?</b></span></li>
<li class="has-sub"><a href="4-shiny-intro.html#shiny-intro"><span class="toc-section-number">4</span> Introduction</a><ul>
<li><a href="4-1-shiny-html-css-and-javascript.html#shiny-html-css-and-javascript"><span class="toc-section-number">4.1</span> Shiny, HTML, CSS and JavaScript</a></li>
<li><a href="4-2-shiny-websocket.html#shiny-websocket"><span class="toc-section-number">4.2</span> Websocket: R/JS bidirectional communication</a></li>
<li><a href="4-3-shiny-session.html#shiny-session"><span class="toc-section-number">4.3</span> The Shiny session object</a></li>
</ul></li>
<li class="has-sub"><a href="5-shiny-input-system.html#shiny-input-system"><span class="toc-section-number">5</span> Shiny’s input system</a><ul>
<li><a href="5-1-shiny-javascript-sources.html#shiny-javascript-sources"><span class="toc-section-number">5.1</span> Shiny JavaScript sources</a></li>
<li><a href="5-2-the-shiny-javascript-object.html#the-shiny-javascript-object"><span class="toc-section-number">5.2</span> The Shiny JavaScript object</a></li>
<li><a href="5-3-initialization.html#initialization"><span class="toc-section-number">5.3</span> Initialization</a></li>
<li class="has-sub"><a href="5-4-input-bindings.html#input-bindings"><span class="toc-section-number">5.4</span> Input bindings</a><ul>
<li><a href="5-4-input-bindings.html#input-structure"><span class="toc-section-number">5.4.1</span> Input structure</a></li>
<li><a href="5-4-input-bindings.html#binding-shiny-inputs"><span class="toc-section-number">5.4.2</span> Binding Shiny inputs</a></li>
<li><a href="5-4-input-bindings.html#binding-other-elements"><span class="toc-section-number">5.4.3</span> Binding other elements</a></li>
</ul></li>
<li class="has-sub"><a href="5-5-utilities-to-quickly-define-new-inputs.html#utilities-to-quickly-define-new-inputs"><span class="toc-section-number">5.5</span> Utilities to quickly define new inputs</a><ul>
<li><a href="3-1-introduction.html#introduction"><span class="toc-section-number">5.5.1</span> Introduction</a></li>
<li><a href="5-5-utilities-to-quickly-define-new-inputs.html#examples"><span class="toc-section-number">5.5.2</span> Examples</a></li>
<li><a href="5-5-utilities-to-quickly-define-new-inputs.html#custom-data-format"><span class="toc-section-number">5.5.3</span> Custom data format</a></li>
</ul></li>
<li class="has-sub"><a href="5-6-miscellaneous.html#miscellaneous"><span class="toc-section-number">5.6</span> Miscellaneous</a><ul>
<li><a href="5-6-miscellaneous.html#get-access-to-initial-values"><span class="toc-section-number">5.6.1</span> Get access to initial values</a></li>
</ul></li>
</ul></li>
<li><a href="6-shiny-custom-handler.html#shiny-custom-handler"><span class="toc-section-number">6</span> Custom handlers: from R to JavaScript</a></li>
<li class="part"><span><b>htmltools</b></span></li>
<li class="has-sub"><a href="7-htmltools-overview.html#htmltools-overview"><span class="toc-section-number">7</span> htmltools overview</a><ul>
<li><a href="7-1-html-tags.html#html-tags"><span class="toc-section-number">7.1</span> HTML Tags</a></li>
<li><a href="7-2-notations.html#notations"><span class="toc-section-number">7.2</span> Notations</a></li>
<li><a href="7-3-adding-new-tags.html#adding-new-tags"><span class="toc-section-number">7.3</span> Adding new tags</a></li>
<li><a href="7-4-alternative-way-to-write-tags.html#alternative-way-to-write-tags"><span class="toc-section-number">7.4</span> Alternative way to write tags</a></li>
<li class="has-sub"><a href="7-5-playing-with-tags.html#playing-with-tags"><span class="toc-section-number">7.5</span> Playing with tags</a><ul>
<li><a href="7-5-playing-with-tags.html#tags-structure"><span class="toc-section-number">7.5.1</span> Tags structure</a></li>
<li><a href="7-5-playing-with-tags.html#useful-functions-for-tags"><span class="toc-section-number">7.5.2</span> Useful functions for tags</a></li>
<li><a href="7-5-playing-with-tags.html#other-interesting-functions"><span class="toc-section-number">7.5.3</span> Other interesting functions</a></li>
<li><a href="7-5-playing-with-tags.html#conditionally-set-attributes"><span class="toc-section-number">7.5.4</span> Conditionally set attributes</a></li>
<li><a href="7-5-playing-with-tags.html#using"><span class="toc-section-number">7.5.5</span> Using %&gt;%</a></li>
<li><a href="7-5-playing-with-tags.html#programmatically-create-children-elements"><span class="toc-section-number">7.5.6</span> Programmatically create children elements</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="8-htmltools-dependencies.html#htmltools-dependencies"><span class="toc-section-number">8</span> Dependency utilities</a><ul>
<li><a href="8-1-the-dirty-approach.html#the-dirty-approach"><span class="toc-section-number">8.1</span> The dirty approach</a></li>
<li><a href="8-2-the-clean-approach.html#the-clean-approach"><span class="toc-section-number">8.2</span> The clean approach</a></li>
<li><a href="8-3-another-example-importing-html-dependencies-from-other-packages.html#another-example-importing-html-dependencies-from-other-packages"><span class="toc-section-number">8.3</span> Another example: Importing HTML dependencies from other packages</a></li>
<li><a href="8-4-suppress-dependencies.html#suppress-dependencies"><span class="toc-section-number">8.4</span> Suppress dependencies</a></li>
</ul></li>
<li class="has-sub"><a href="9-htmltools-other-tools.html#htmltools-other-tools"><span class="toc-section-number">9</span> Other tools</a><ul>
<li><a href="9-1-css.html#css"><span class="toc-section-number">9.1</span> CSS</a></li>
</ul></li>
<li class="part"><span><b>Practice 1: a dashboard template</b></span></li>
<li><a href="10-custom-templates-selection.html#custom-templates-selection"><span class="toc-section-number">10</span> Template selection</a></li>
<li class="has-sub"><a href="11-custom-templates-package.html#custom-templates-package"><span class="toc-section-number">11</span> Package creation</a><ul>
<li><a href="3-1-introduction.html#introduction"><span class="toc-section-number">11.1</span> Introduction</a></li>
<li><a href="11-2-step-by-step.html#step-by-step"><span class="toc-section-number">11.2</span> Step by step</a></li>
</ul></li>
<li class="has-sub"><a href="12-custom-templates-dependencies.html#custom-templates-dependencies"><span class="toc-section-number">12</span> Define dependencies</a><ul>
<li><a href="12-1-discover-the-project.html#discover-the-project"><span class="toc-section-number">12.1</span> Discover the project</a></li>
<li><a href="12-2-identify-mandatory-dependencies.html#identify-mandatory-dependencies"><span class="toc-section-number">12.2</span> Identify mandatory dependencies</a></li>
<li><a href="12-3-bundle-dependencies.html#bundle-dependencies"><span class="toc-section-number">12.3</span> Bundle dependencies</a></li>
</ul></li>
<li class="has-sub"><a href="13-custom-templates-skeleton.html#custom-templates-skeleton"><span class="toc-section-number">13</span> Template skeleton</a><ul>
<li><a href="13-1-identify-template-elements.html#identify-template-elements"><span class="toc-section-number">13.1</span> Identify template elements</a></li>
<li class="has-sub"><a href="13-2-design-the-page-layout.html#design-the-page-layout"><span class="toc-section-number">13.2</span> Design the page layout</a><ul>
<li><a href="13-2-design-the-page-layout.html#the-page-wrapper"><span class="toc-section-number">13.2.1</span> The page wrapper</a></li>
<li><a href="13-2-design-the-page-layout.html#the-body-content"><span class="toc-section-number">13.2.2</span> The body content</a></li>
<li><a href="13-2-design-the-page-layout.html#the-footer"><span class="toc-section-number">13.2.3</span> The footer</a></li>
<li><a href="13-2-design-the-page-layout.html#the-navbar-or-header"><span class="toc-section-number">13.2.4</span> The navbar (or header)</a></li>
<li><a href="13-2-design-the-page-layout.html#card-containers"><span class="toc-section-number">13.2.5</span> Card containers</a></li>
<li><a href="13-2-design-the-page-layout.html#ribbons-card-components"><span class="toc-section-number">13.2.6</span> Ribbons: card components</a></li>
<li><a href="13-2-design-the-page-layout.html#icons"><span class="toc-section-number">13.2.7</span> Icons</a></li>
</ul></li>
<li><a href="13-3-exercises.html#exercises"><span class="toc-section-number">13.3</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="14-custom-templates-testing.html#custom-templates-testing"><span class="toc-section-number">14</span> Testing and validating templates elements</a><ul>
<li class="has-sub"><a href="14-1-validate-template-functions.html#validate-template-functions"><span class="toc-section-number">14.1</span> Validate template functions</a><ul>
<li><a href="14-1-validate-template-functions.html#create-your-own-validations"><span class="toc-section-number">14.1.1</span> Create your own validations</a></li>
<li><a href="14-1-validate-template-functions.html#existing-utils-functions"><span class="toc-section-number">14.1.2</span> Existing utils functions</a></li>
<li><a href="14-1-validate-template-functions.html#example-refine-navbar-menu-items"><span class="toc-section-number">14.1.3</span> Example: refine navbar menu items</a></li>
</ul></li>
<li class="has-sub"><a href="14-2-testing-templates-elements.html#testing-templates-elements"><span class="toc-section-number">14.2</span> Testing templates elements</a><ul>
<li><a href="14-2-testing-templates-elements.html#testing-template-behavior"><span class="toc-section-number">14.2.1</span> Testing template behavior</a></li>
</ul></li>
<li><a href="14-3-testing-javascript.html#testing-javascript"><span class="toc-section-number">14.3</span> Testing JavaScript</a></li>
</ul></li>
<li class="has-sub"><a href="15-custom-templates-inputs.html#custom-templates-inputs"><span class="toc-section-number">15</span> Develop custom input widgets</a><ul>
<li class="has-sub"><a href="15-1-tabler-action-button.html#tabler-action-button"><span class="toc-section-number">15.1</span> Tabler action button</a><ul>
<li><a href="15-1-tabler-action-button.html#reminders-about-the-action-button"><span class="toc-section-number">15.1.1</span> Reminders about the action button</a></li>
<li><a href="15-1-tabler-action-button.html#application-to-tabler"><span class="toc-section-number">15.1.2</span> Application to Tabler</a></li>
</ul></li>
<li><a href="15-2-toggle-switch.html#toggle-switch"><span class="toc-section-number">15.2</span> Toggle Switch</a></li>
<li><a href="15-3-navbar-menu-input.html#navbar-menu-input"><span class="toc-section-number">15.3</span> Navbar menu input</a></li>
<li><a href="13-3-exercises.html#exercises"><span class="toc-section-number">15.4</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="16-custom-templates-interactivity.html#custom-templates-interactivity"><span class="toc-section-number">16</span> Adding more interactivity</a><ul>
<li><a href="16-1-custom-progress-bars.html#custom-progress-bars"><span class="toc-section-number">16.1</span> Custom progress bars</a></li>
<li class="has-sub"><a href="16-2-user-feedback-toasts.html#user-feedback-toasts"><span class="toc-section-number">16.2</span> User feedback: toasts</a><ul>
<li><a href="16-2-user-feedback-toasts.html#toast-skeleton"><span class="toc-section-number">16.2.1</span> Toast skeleton</a></li>
<li><a href="16-2-user-feedback-toasts.html#the-toast-api"><span class="toc-section-number">16.2.2</span> The toast API</a></li>
<li><a href="16-2-user-feedback-toasts.html#r-implementation"><span class="toc-section-number">16.2.3</span> R implementation</a></li>
<li><a href="16-2-user-feedback-toasts.html#wrap-up"><span class="toc-section-number">16.2.4</span> Wrap up</a></li>
</ul></li>
<li><a href="16-3-transform-an-element-in-a-custom-action-button.html#transform-an-element-in-a-custom-action-button"><span class="toc-section-number">16.3</span> Transform an element in a custom action button</a></li>
<li class="has-sub"><a href="16-4-tab-events.html#tab-events"><span class="toc-section-number">16.4</span> Tab events</a><ul>
<li><a href="16-4-tab-events.html#insert-tabs"><span class="toc-section-number">16.4.1</span> Insert/Remove tabs in tabsetpanel</a></li>
</ul></li>
<li><a href="13-3-exercises.html#exercises"><span class="toc-section-number">16.5</span> Exercises</a></li>
</ul></li>
<li class="part"><span><b>Beautify with CSS and SASS</b></span></li>
<li class="has-sub"><a href="17-beautify-with-fresh.html#beautify-with-fresh"><span class="toc-section-number">17</span> Beautify with fresh</a><ul>
<li><a href="17-1-fresh-the-big-picture.html#fresh-the-big-picture"><span class="toc-section-number">17.1</span> {fresh}, the big picture</a></li>
</ul></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="input-bindings" class="section level2">
<h2><span class="header-section-number">5.4</span> Input bindings</h2>
<div id="input-structure" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Input structure</h3>
<p>An input element is given by the <code>&lt;input&gt;</code> tag as well as several attributes.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb59-1"><a href="5-4-input-bindings.html#cb59-1"></a><span class="kw">&lt;input</span><span class="ot"> id</span> <span class="ot">=</span> <span class="st">inputId</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text&quot;</span><span class="ot"> class</span> <span class="ot">=</span> <span class="st">&quot;input-text&quot;</span><span class="ot"> value</span> <span class="ot">=</span> <span class="st">value</span><span class="kw">&gt;</span></span></code></pre></div>
<ul>
<li>id garantees the input uniquess. We will see very soon that all instances of the same input share a unique input binding, therefore id is mandatory.</li>
<li><a href="https://www.w3schools.com/tags/att_input_type.asp">type</a></li>
<li>class is targeted by CSS and JavaScript</li>
<li>value holds the input value</li>
</ul>
</div>
<div id="binding-shiny-inputs" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Binding Shiny inputs</h3>
<p>An input binding allows Shiny to identify each instance of a given input and what you may do with this input. For instance, a slider input must update whenever the range is dragged or when the left and right arrows of the keyboard are pressed. It relies on a class defined in the <code>input_binding.js</code> <a href="https://github.com/rstudio/shiny/blob/master/srcjs/input_binding.js">file</a>.</p>
<p>Let’s describe each method chronologically. For better convenience, the book side package contains step by step demonstrations which may be found <a href="https://github.com/DivadNojnarg/outstanding-shiny-ui-code/blob/master/R/inputs.R">here</a>. Each example is called by the <code>customTextInputExample</code>, which takes the input binding step as only parameter. For instance <code>customTextInputExample(1)</code> will invoke the first step.</p>
<div id="find-the-input" class="section level4">
<h4><span class="header-section-number">5.4.2.1</span> Find the input</h4>
<p>The first step, is critical which is to locate the input in the DOM. On the R side, we define an input, with a specific attribute that will serve as a receptor for the binding. For most of inputs, this may be handled by the type attribute. In other cases, this may be the class, like for the <code>actionButton</code>. On the JS side, we need a method that will identify this receptor. Moreover, two different types of inputs (for instance <code>radioButton</code> and <code>selectInput</code>) cannot have the same receptor for conflict reasons, whereas two instances of the same input type can (if your app contains 10 sliders, they all share the same input binding!). The receptor identifier is provided by the <code>find</code> method of the <code>InputBinding</code> class. This method must be applied on a scope, that is the <code>document</code>. <code>find</code> accepts any valid jQuery selector. Note the <code>console.log</code> only here for debugging purpose.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb60-1"><a href="5-4-input-bindings.html#cb60-1"></a>find<span class="op">:</span> <span class="kw">function</span>(scope) <span class="op">{</span></span>
<span id="cb60-2"><a href="5-4-input-bindings.html#cb60-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="at">$</span>(scope).<span class="at">find</span>(<span class="st">&#39;.input-text&#39;</span>))<span class="op">;</span></span>
<span id="cb60-3"><a href="5-4-input-bindings.html#cb60-3"></a>  <span class="cf">return</span> <span class="at">$</span>(scope).<span class="at">find</span>(<span class="st">&#39;.input-text&#39;</span>)<span class="op">;</span></span>
<span id="cb60-4"><a href="5-4-input-bindings.html#cb60-4"></a><span class="op">}</span></span></code></pre></div>
<p>Figure <a href="5-4-input-bindings.html#fig:shiny-find-inputs">5.4</a> summarizes this important step.</p>
<div class="figure"><span id="fig:shiny-find-inputs"></span>
<img src="images/survival-kit/shiny-find-inputs.png" alt="How to find inputs?" width="720" />
<p class="caption">
FIGURE 5.4: How to find inputs?
</p>
</div>
<p>Below, we are going to create a new binding for the <code>textInput</code>, with only two methods mentioned in the previous section, that is <code>find</code> and <code>getValue</code>. For that, we need to create a customized text input, <code>customTextInput</code> to make it unique. We now add the <code>input-text</code> class and make our own input binding pointing to that specific class.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="5-4-input-bindings.html#cb61-1"></a>customTextInput &lt;-<span class="st"> </span><span class="cf">function</span> (inputId, label, <span class="dt">value =</span> <span class="st">&quot;&quot;</span>, <span class="dt">width =</span> <span class="ot">NULL</span>, <span class="dt">placeholder =</span> <span class="ot">NULL</span>) {</span>
<span id="cb61-2"><a href="5-4-input-bindings.html#cb61-2"></a>  </span>
<span id="cb61-3"><a href="5-4-input-bindings.html#cb61-3"></a>  <span class="co"># this external wrapper ensure to control the input width</span></span>
<span id="cb61-4"><a href="5-4-input-bindings.html#cb61-4"></a>  <span class="kw">div</span>(</span>
<span id="cb61-5"><a href="5-4-input-bindings.html#cb61-5"></a>    <span class="dt">class =</span> <span class="st">&quot;form-group shiny-input-container&quot;</span>, </span>
<span id="cb61-6"><a href="5-4-input-bindings.html#cb61-6"></a>    <span class="dt">style =</span> <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(width)) {</span>
<span id="cb61-7"><a href="5-4-input-bindings.html#cb61-7"></a>      <span class="kw">paste0</span>(<span class="st">&quot;width: &quot;</span>, <span class="kw">validateCssUnit</span>(width), <span class="st">&quot;;&quot;</span>)</span>
<span id="cb61-8"><a href="5-4-input-bindings.html#cb61-8"></a>    },</span>
<span id="cb61-9"><a href="5-4-input-bindings.html#cb61-9"></a>    <span class="co"># input label</span></span>
<span id="cb61-10"><a href="5-4-input-bindings.html#cb61-10"></a>    <span class="kw">shinyInputLabel</span>(inputId, label), </span>
<span id="cb61-11"><a href="5-4-input-bindings.html#cb61-11"></a>    </span>
<span id="cb61-12"><a href="5-4-input-bindings.html#cb61-12"></a>    <span class="co"># input element + JS dependencies</span></span>
<span id="cb61-13"><a href="5-4-input-bindings.html#cb61-13"></a>    <span class="kw">tagList</span>(</span>
<span id="cb61-14"><a href="5-4-input-bindings.html#cb61-14"></a>      <span class="kw">customTextInputDeps</span>(),</span>
<span id="cb61-15"><a href="5-4-input-bindings.html#cb61-15"></a>      tags<span class="op">$</span><span class="kw">input</span>(</span>
<span id="cb61-16"><a href="5-4-input-bindings.html#cb61-16"></a>        <span class="dt">id =</span> inputId,</span>
<span id="cb61-17"><a href="5-4-input-bindings.html#cb61-17"></a>        <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb61-18"><a href="5-4-input-bindings.html#cb61-18"></a>        <span class="dt">class =</span> <span class="st">&quot;form-control input-text&quot;</span>,</span>
<span id="cb61-19"><a href="5-4-input-bindings.html#cb61-19"></a>        <span class="dt">value =</span> value,</span>
<span id="cb61-20"><a href="5-4-input-bindings.html#cb61-20"></a>        <span class="dt">placeholder =</span> placeholder</span>
<span id="cb61-21"><a href="5-4-input-bindings.html#cb61-21"></a>      )</span>
<span id="cb61-22"><a href="5-4-input-bindings.html#cb61-22"></a>    )</span>
<span id="cb61-23"><a href="5-4-input-bindings.html#cb61-23"></a>  )</span>
<span id="cb61-24"><a href="5-4-input-bindings.html#cb61-24"></a>}</span></code></pre></div>
<p>The last part of the code contains a <code>tagList</code> with two elements:</p>
<ul>
<li>The element input binding</li>
<li>The input tag</li>
</ul>
<p>Below is an example of how we managed the dependency creation in our side package.
Considering multiple inputs, we will add more script to the dependency by passing a vector to the script parameter.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="5-4-input-bindings.html#cb62-1"></a>customTextInputDeps &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb62-2"><a href="5-4-input-bindings.html#cb62-2"></a>  <span class="kw">htmlDependency</span>(</span>
<span id="cb62-3"><a href="5-4-input-bindings.html#cb62-3"></a>    <span class="dt">name =</span> <span class="st">&quot;customTextBindings&quot;</span>,</span>
<span id="cb62-4"><a href="5-4-input-bindings.html#cb62-4"></a>    <span class="dt">version =</span> <span class="st">&quot;1.0.0&quot;</span>,</span>
<span id="cb62-5"><a href="5-4-input-bindings.html#cb62-5"></a>    <span class="dt">src =</span> <span class="kw">c</span>(<span class="dt">file =</span> <span class="kw">system.file</span>(<span class="st">&quot;chapter5/input-bindings&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;OSUICode&quot;</span>)),</span>
<span id="cb62-6"><a href="5-4-input-bindings.html#cb62-6"></a>    <span class="dt">script =</span> <span class="st">&quot;customTextInputBinding.js&quot;</span></span>
<span id="cb62-7"><a href="5-4-input-bindings.html#cb62-7"></a>  )</span>
<span id="cb62-8"><a href="5-4-input-bindings.html#cb62-8"></a>}</span></code></pre></div>
<p>In the <a href="https://github.com/RinteRface/shinyMobile/tree/master/inst/framework7-5.5.0">shinyMobile</a> package, we chose a more robust approach. All bindings are contained in a folder and compressed so that we generate only one minified file containing all collapsed bindings.</p>
<p>Figure <a href="5-4-input-bindings.html#fig:text-input">5.5</a> shows the main elements of the <code>textInput</code> widget. In the above code, <code>shinyInputLabel</code> is a Shiny internal function that creates the numeric input label, or in other word the text displayed next to it. The core input element is wrapped by <code>tags$input</code>. No worry if the structure seems unclear, we will give more details about shiny tags in the Chapter <a href="7-htmltools-overview.html#htmltools-overview">7</a>.</p>
<div class="figure"><span id="fig:text-input"></span>
<img src="images/survival-kit/text-input.png" alt="Shiny's textInput elements" width="350" />
<p class="caption">
FIGURE 5.5: Shiny’s textInput elements
</p>
</div>
<p>We invite the reader to run the first example below and open the HTML inspector and look at the <code>console.log</code> result.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="5-4-input-bindings.html#cb63-1"></a><span class="kw">customTextInputExample</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>Results are shown on Figure <a href="5-4-input-bindings.html#fig:shiny-find-inputs-result">5.6</a>. If the corresponding input is found, you should see the corresponding tag element in the HTML inspector console.</p>
<div class="figure"><span id="fig:shiny-find-inputs-result"></span>
<img src="images/survival-kit/shiny-find-inputs-result.png" alt="find method output" width="1289" />
<p class="caption">
FIGURE 5.6: find method output
</p>
</div>
</div>
<div id="initialize-inputs" class="section level4">
<h4><span class="header-section-number">5.4.2.2</span> Initialize inputs</h4>
<p>Upon initialization, Shiny calls the <code>initializeInputs</code> function that takes all input bindings and call their <code>initialize</code> method before binding all inputs. Note that once an input has been initialized it has a <code>_shiny_initialized</code> tag to avoid initializing it twice. The initialize method is not always defined but some elements require to be explicitly initialized or activated. For instance the <a href="https://framework7.io">Framework7</a> API, on top of which <a href="https://github.com/RinteRface/shinyMobile">shinyMobile</a> is built, require to instantiate all elements. Below is an example for the <a href="https://framework7.io/docs/toggle.html">toggle</a> input:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb64-1"><a href="5-4-input-bindings.html#cb64-1"></a><span class="co">// what is expected</span></span>
<span id="cb64-2"><a href="5-4-input-bindings.html#cb64-2"></a><span class="kw">let</span> toggle <span class="op">=</span> <span class="va">app</span>.<span class="va">toggle</span>.<span class="at">create</span>(<span class="op">{</span></span>
<span id="cb64-3"><a href="5-4-input-bindings.html#cb64-3"></a>  <span class="dt">el</span><span class="op">:</span> <span class="st">&#39;.toggle&#39;</span><span class="op">,</span></span>
<span id="cb64-4"><a href="5-4-input-bindings.html#cb64-4"></a>  <span class="dt">on</span><span class="op">:</span> <span class="op">{</span></span>
<span id="cb64-5"><a href="5-4-input-bindings.html#cb64-5"></a>    <span class="dt">change</span><span class="op">:</span> <span class="kw">function</span> () <span class="op">{</span></span>
<span id="cb64-6"><a href="5-4-input-bindings.html#cb64-6"></a>      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Toggle changed&#39;</span>)</span>
<span id="cb64-7"><a href="5-4-input-bindings.html#cb64-7"></a>    <span class="op">}</span></span>
<span id="cb64-8"><a href="5-4-input-bindings.html#cb64-8"></a>  <span class="op">}</span></span>
<span id="cb64-9"><a href="5-4-input-bindings.html#cb64-9"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p><code>el: '.toggle'</code> means that we are looking at the element(s) having the <code>toggle</code> class. <code>app.toggle.create</code> is internal to the Framework7 API. The corresponding shinyMobile input binding starts as follows.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb65-1"><a href="5-4-input-bindings.html#cb65-1"></a><span class="kw">var</span> f7ToggleBinding <span class="op">=</span> <span class="kw">new</span> <span class="va">Shiny</span>.<span class="at">InputBinding</span>()<span class="op">;</span></span>
<span id="cb65-2"><a href="5-4-input-bindings.html#cb65-2"></a>  <span class="va">$</span>.<span class="at">extend</span>(f7ToggleBinding<span class="op">,</span> <span class="op">{</span></span>
<span id="cb65-3"><a href="5-4-input-bindings.html#cb65-3"></a>    <span class="dt">initialize</span><span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb65-4"><a href="5-4-input-bindings.html#cb65-4"></a>      <span class="va">app</span>.<span class="va">toggle</span>.<span class="at">create</span>(<span class="op">{</span><span class="dt">el</span><span class="op">:</span> el<span class="op">}</span>)<span class="op">;</span></span>
<span id="cb65-5"><a href="5-4-input-bindings.html#cb65-5"></a>    <span class="op">},</span></span>
<span id="cb65-6"><a href="5-4-input-bindings.html#cb65-6"></a>    <span class="co">// other methods</span></span>
<span id="cb65-7"><a href="5-4-input-bindings.html#cb65-7"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>Once initialized, we may use all specific methods provided by the API. <a href="https://framework7.io">Framework7</a> is clearly a gold mine, as its API provides many possible options for many inputs / widgets. Later in this section, we will demonstrate how to initialize a box element from the <a href="https://adminlte.io/docs/2.4/js-box-widget">AdminLTE2</a> HTML template.</p>
</div>
<div id="get-the-value" class="section level4">
<h4><span class="header-section-number">5.4.2.3</span> Get the value</h4>
<p><code>getValue(el)</code> returns the input value. The way to obtain the value is different for almost all inputs. For instance, the <code>textInput</code> is pretty simple since the value is located in the <code>value</code> attribute. <code>el</code> refers to the element holding the id attribute and recognized by the <code>find</code> method. Figure <a href="5-4-input-bindings.html#fig:shiny-el">5.7</a> shows the result of a <code>console.log($(el));</code>.</p>
<div class="figure"><span id="fig:shiny-el"></span>
<img src="images/survival-kit/shiny-el.png" alt="About el" width="1278" />
<p class="caption">
FIGURE 5.7: About el
</p>
</div>
<div class="sourceCode" id="cb66"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb66-1"><a href="5-4-input-bindings.html#cb66-1"></a>getValue<span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb66-2"><a href="5-4-input-bindings.html#cb66-2"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="at">$</span>(el))<span class="op">;</span></span>
<span id="cb66-3"><a href="5-4-input-bindings.html#cb66-3"></a>  <span class="cf">return</span> <span class="at">$</span>(el).<span class="at">val</span>()<span class="op">;</span></span>
<span id="cb66-4"><a href="5-4-input-bindings.html#cb66-4"></a><span class="op">}</span></span></code></pre></div>
<p>To get the value, we apply the jQuery method <code>val</code> on the <code>$(el)</code> element and return the result.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="5-4-input-bindings.html#cb67-1"></a><span class="kw">customTextInputExample</span>(<span class="dv">2</span>)</span></code></pre></div>
<p>This time, the input value is returned. Notice that when you try to change the text content, the output value does not update as we would normally expect. We are actually missing a couple of methods so that the binding is fully working. We will introduce them in the following sections!</p>
</div>
<div id="set-and-update" class="section level4">
<h4><span class="header-section-number">5.4.2.4</span> Set and update</h4>
<p><code>setValue(el, value)</code> is used to set the value of the current input. This method is necessary so that the input value may be updated. It has to be used in combination with <code>receiveMessage(el, data)</code>, which is the JavaScript part of all the R <code>updateInput</code> functions. We usually call the <code>setValue</code> method inside.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb68-1"><a href="5-4-input-bindings.html#cb68-1"></a>setValue<span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> value) <span class="op">{</span></span>
<span id="cb68-2"><a href="5-4-input-bindings.html#cb68-2"></a>  <span class="at">$</span>(el).<span class="at">val</span>(value)<span class="op">;</span></span>
<span id="cb68-3"><a href="5-4-input-bindings.html#cb68-3"></a><span class="op">}</span></span></code></pre></div>
<p>Let’s create a function to update our custom text input. Call it <code>updateCustomTextInput</code>. It requires at least 3 parameters:</p>
<ul>
<li>inputId tells which input to update.</li>
<li>value is the new value. This will be taken by the <code>setValue</code> JS method in the input binding</li>
<li>session is the Shiny session object mentioned earlier. We will use the <code>sendInputMessage</code> to send values from R to JavaScript. The <code>receiveMessage</code> method will apply <code>setValue</code> with the data received from R.</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="5-4-input-bindings.html#cb69-1"></a>updateCustomTextInput &lt;-<span class="st"> </span><span class="cf">function</span>(inputId, <span class="dt">value =</span> <span class="ot">NULL</span>, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()) {</span>
<span id="cb69-2"><a href="5-4-input-bindings.html#cb69-2"></a>  session<span class="op">$</span><span class="kw">sendInputMessage</span>(inputId, <span class="dt">message =</span> value)</span>
<span id="cb69-3"><a href="5-4-input-bindings.html#cb69-3"></a>}</span></code></pre></div>
<p>We add <code>setValue</code> and <code>receiveMessage</code> to custom input binding.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="5-4-input-bindings.html#cb70-1"></a><span class="kw">updateCustomTextInputExample</span>(<span class="dv">3</span>)</span></code></pre></div>
<p>Figure <a href="5-4-input-bindings.html#fig:shiny-update-inputs">5.8</a> illustrates the main mechanisms.</p>
<div class="figure"><span id="fig:shiny-update-inputs"></span>
<img src="images/survival-kit/shiny-update-inputs.png" alt="Events following a click on the update button. This figure demonstrates how R and JS communicate, through the websocket." width="720" />
<p class="caption">
FIGURE 5.8: Events following a click on the update button. This figure demonstrates how R and JS communicate, through the websocket.
</p>
</div>
<p>If we have to pass multiple elements to update, we would have to change the <code>updateCustomTextInput</code> function such as:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="5-4-input-bindings.html#cb71-1"></a>updateCustomTextInput &lt;-<span class="st"> </span><span class="cf">function</span>(inputId, <span class="dt">value =</span> <span class="ot">NULL</span>, <span class="dt">placeholder =</span> <span class="ot">NULL</span>, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()) {</span>
<span id="cb71-2"><a href="5-4-input-bindings.html#cb71-2"></a>  message &lt;-<span class="st"> </span><span class="kw">dropNulls</span>(</span>
<span id="cb71-3"><a href="5-4-input-bindings.html#cb71-3"></a>    <span class="kw">list</span>(</span>
<span id="cb71-4"><a href="5-4-input-bindings.html#cb71-4"></a>      <span class="dt">value =</span> value,</span>
<span id="cb71-5"><a href="5-4-input-bindings.html#cb71-5"></a>      <span class="dt">placeholder =</span> placeholder</span>
<span id="cb71-6"><a href="5-4-input-bindings.html#cb71-6"></a>    )</span>
<span id="cb71-7"><a href="5-4-input-bindings.html#cb71-7"></a>  )</span>
<span id="cb71-8"><a href="5-4-input-bindings.html#cb71-8"></a>  session<span class="op">$</span><span class="kw">sendInputMessage</span>(inputId, message)</span>
<span id="cb71-9"><a href="5-4-input-bindings.html#cb71-9"></a>}</span></code></pre></div>
<p><code>dropNulls</code> is an internal function ensuring that the list does not contain NULL elements. We send a list from R, which is then serialized to a JSON object. In the <code>receiveMessage</code> method, properties like <code>value</code> may be accessed using the . notation:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb72-1"><a href="5-4-input-bindings.html#cb72-1"></a>receiveMessage<span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> data) <span class="op">{</span></span>
<span id="cb72-2"><a href="5-4-input-bindings.html#cb72-2"></a>  <span class="va">console</span>.<span class="at">log</span>(data)<span class="op">;</span></span>
<span id="cb72-3"><a href="5-4-input-bindings.html#cb72-3"></a>  <span class="cf">if</span> (<span class="va">data</span>.<span class="at">hasOwnProperty</span>(<span class="st">&#39;value&#39;</span>)) <span class="op">{</span></span>
<span id="cb72-4"><a href="5-4-input-bindings.html#cb72-4"></a>    <span class="kw">this</span>.<span class="at">setValue</span>(el<span class="op">,</span> <span class="va">data</span>.<span class="at">value</span>)<span class="op">;</span></span>
<span id="cb72-5"><a href="5-4-input-bindings.html#cb72-5"></a>  <span class="op">}</span></span>
<span id="cb72-6"><a href="5-4-input-bindings.html#cb72-6"></a>  <span class="co">// other parameters to update...</span></span>
<span id="cb72-7"><a href="5-4-input-bindings.html#cb72-7"></a><span class="op">}</span></span></code></pre></div>
<p>So far so good! We managed to update the text input value. Yet, after clicking the button, the output value does not change. We are going to fix this missing step in the next section.</p>
</div>
<div id="subscribe" class="section level4">
<h4><span class="header-section-number">5.4.2.5</span> Subscribe</h4>
<p><code>subscribe(el, callback)</code> listens to events defining Shiny to update the input value and make it available in the app. Some API like Bootstrap explicitly mention those events (like <code>hide.bs.tab</code>, <code>shown.bs.tab</code>, …).
Going back to our custom text input, what event would make it change?</p>
<ul>
<li>After a key is release on the keyboard. We may listen to <code>keyup</code></li>
<li>After copying and pasting any text in the input field or dictating text. The <code>input</code> event may be helpful</li>
</ul>
<p>We may add those <a href="https://javascript.info/events-change-input">events</a> to our binding using an event listener seen at the end of Chapter <a href="3-survival-kit-javascript.html#survival-kit-javascript">3</a>.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb73-1"><a href="5-4-input-bindings.html#cb73-1"></a><span class="at">$</span>(el).<span class="at">on</span>(<span class="st">&#39;keyup.customTextBinding input.customTextBinding&#39;</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></span>
<span id="cb73-2"><a href="5-4-input-bindings.html#cb73-2"></a>  <span class="at">callback</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb73-3"><a href="5-4-input-bindings.html#cb73-3"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p><code>callback</code> ensures that the new value is captured by Shiny. We will come back later on the callback parameter.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="5-4-input-bindings.html#cb74-1"></a><span class="kw">updateCustomTextInputExample</span>(<span class="dv">4</span>)</span></code></pre></div>
<p>Hooray! The output result is successfully changed when the input value is manually updated. However, nothing happens when we click on the update button. What did we miss? Looking back at the <code>receiveMessage</code> method, we changed the input value but how does Shiny knows that this step was successful? To check that no event is raised, we put a <code>console.log(event);</code> in the <code>subscribe</code> method. Any action like removing the text content or adding new text triggers event but clicking on the action button does not. Therefore, we must trigger an event and add it to the <code>subscribe</code> method. We may choose the <code>change</code> event, that triggers when an element is updated.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb75-1"><a href="5-4-input-bindings.html#cb75-1"></a><span class="at">$</span>(el).<span class="at">on</span>(<span class="st">&#39;change.customTextBinding&#39;</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></span>
<span id="cb75-2"><a href="5-4-input-bindings.html#cb75-2"></a>  <span class="at">callback</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb75-3"><a href="5-4-input-bindings.html#cb75-3"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>Let’s try again.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="5-4-input-bindings.html#cb76-1"></a><span class="kw">updateCustomTextInputExample</span>(<span class="dv">5</span>)</span></code></pre></div>
<p>Perfect? Not exactly.</p>
</div>
<div id="setting-rate-policies" class="section level4">
<h4><span class="header-section-number">5.4.2.6</span> Setting rate policies</h4>
<p>It would be better to only change the input value once the keyboard is completely released for some time (and not each time a key is released). This is what we call debouncing, which allows a delay before telling Shiny to read the new value, and is achieved using the <code>getRatePolicy</code> method. Additionally, we must also pass <code>true</code> to the <code>callback</code> in the subscribe method, in order to apply our specific rate policy (<a href="https://davidwalsh.name/javascript-debounce-function">debounce</a>, throttle). This is useful for instance when we don’t want to flood the server with useless update requests. For example when using a slider, we only want to send the value as soon as the range stops moving and not all intermediate values. Those elements are defined <a href="https://github.com/rstudio/shiny/blob/master/srcjs/input_rate.js">here</a>.</p>
<p>Run the app below and try to manually change the text input value by adding a couple of letters as fast as you can. What do you notice? We see the output value only updates when we release the keyboard.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="5-4-input-bindings.html#cb77-1"></a><span class="kw">customTextInputExample</span>(<span class="dv">6</span>)</span></code></pre></div>
<p>You may adjust the delay according to your needs, but we caution to not set the delay too long as this becomes problematic too.</p>
</div>
<div id="register-an-input-binding" class="section level4">
<h4><span class="header-section-number">5.4.2.7</span> Register an input binding</h4>
<p>At the end of the input binding definition, we register it for Shiny.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb78-1"><a href="5-4-input-bindings.html#cb78-1"></a><span class="kw">let</span> myBinding <span class="op">=</span> <span class="kw">new</span> <span class="va">Shiny</span>.<span class="at">inputBinding</span>()<span class="op">;</span></span>
<span id="cb78-2"><a href="5-4-input-bindings.html#cb78-2"></a>  <span class="va">$</span>.<span class="at">extend</span>(myBinding<span class="op">,</span> <span class="op">{</span></span>
<span id="cb78-3"><a href="5-4-input-bindings.html#cb78-3"></a>  <span class="co">// methods go here</span></span>
<span id="cb78-4"><a href="5-4-input-bindings.html#cb78-4"></a><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb78-5"><a href="5-4-input-bindings.html#cb78-5"></a></span>
<span id="cb78-6"><a href="5-4-input-bindings.html#cb78-6"></a><span class="va">Shiny</span>.<span class="va">inputBindings</span>.<span class="at">register</span>(myBinding<span class="op">,</span> <span class="st">&#39;reference&#39;</span>)<span class="op">;</span></span></code></pre></div>
<p>Although the Shiny <a href="https://shiny.rstudio.com/articles/building-inputs.html">documentation</a> mentions a <code>Shiny.inputBindings.setPriority</code> method to handle conflicting bindings, this case almost never happens.</p>
</div>
</div>
<div id="binding-other-elements" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Binding other elements</h3>
<p>The Shiny input binding system is too convenient to be only used it for input elements. In {shinydashboard}, you may know the <code>box</code> function. Boxes are containers with a title, body, footer, as well as optional elements. It would be nice to capture the state of the box in an input, so as to trigger other actions as soon as this input changes. Since an input value is unique, we must add an <code>inputId</code> parameter to the box function. You may inspect the code <a href="https://github.com/DivadNojnarg/outstanding-shiny-ui-code/blob/master/R/box2.R">here</a>.</p>
<p>Since we may collapse and uncollapse the box, we create the <code>updateBox2</code> function, which will toggle it:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="5-4-input-bindings.html#cb79-1"></a>updateBox2 &lt;-<span class="st"> </span><span class="cf">function</span>(inputId, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()) {</span>
<span id="cb79-2"><a href="5-4-input-bindings.html#cb79-2"></a>  session<span class="op">$</span><span class="kw">sendInputMessage</span>(inputId, <span class="dt">message =</span> <span class="ot">NULL</span>)</span>
<span id="cb79-3"><a href="5-4-input-bindings.html#cb79-3"></a>}</span></code></pre></div>
<p>When collapsed, a box gets the <code>collapsed-box</code> class. Note: this will be useful for the input binding. As mentioned above, it is also necessary to know when to tell Shiny to update the value with the <code>subscribe</code> method. Most of the time, the change event might be sufficient, but as shinydashboard is built on top of <a href="https://adminlte.io/docs/2.4/js-box-widget">AdminLTE2</a>, it has an API to control the box behavior. We identify 2 events corresponding to the collapsible action:</p>
<ul>
<li>expanded.boxwidget (Triggered after the box is expanded)</li>
<li>collapsed.boxwidget (Triggered after the box is collapsed)</li>
</ul>
<p>Unfortunately, after further investigations, those events are not possible to use since the AdminLTE code does not trigger them in the main JS <a href="https://github.com/rstudio/shinydashboard/blob/master/srcjs/AdminLTE/app.js">code</a> (see the collapse method line 577-612). There are other solutions, as shown below with the <code>click</code> event.</p>
<p>There is also a plug and play <code>toggleBox</code> method. To unleash the power of our box, we need to activate it with <code>$('#&lt;box_id&gt;').activateBox();</code> before the binding step. If you remember, the <code>initialize</code> method is exactly doing this:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb80-1"><a href="5-4-input-bindings.html#cb80-1"></a><span class="kw">let</span> boxBinding <span class="op">=</span> <span class="kw">new</span> <span class="va">Shiny</span>.<span class="at">InputBinding</span>()<span class="op">;</span></span>
<span id="cb80-2"><a href="5-4-input-bindings.html#cb80-2"></a><span class="va">$</span>.<span class="at">extend</span>(boxBinding<span class="op">,</span> <span class="op">{</span></span>
<span id="cb80-3"><a href="5-4-input-bindings.html#cb80-3"></a>  <span class="dt">initialize</span><span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb80-4"><a href="5-4-input-bindings.html#cb80-4"></a>    <span class="at">$</span>(el).<span class="at">activateBox</span>()<span class="op">;</span> <span class="co">// box activation</span></span>
<span id="cb80-5"><a href="5-4-input-bindings.html#cb80-5"></a>  <span class="op">},</span></span>
<span id="cb80-6"><a href="5-4-input-bindings.html#cb80-6"></a>  <span class="dt">find</span><span class="op">:</span> <span class="kw">function</span>(scope) <span class="op">{</span></span>
<span id="cb80-7"><a href="5-4-input-bindings.html#cb80-7"></a>    <span class="cf">return</span> <span class="at">$</span>(scope).<span class="at">find</span>(<span class="st">&#39;.box&#39;</span>)<span class="op">;</span></span>
<span id="cb80-8"><a href="5-4-input-bindings.html#cb80-8"></a>  <span class="op">},</span></span>
<span id="cb80-9"><a href="5-4-input-bindings.html#cb80-9"></a>  <span class="dt">getValue</span><span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb80-10"><a href="5-4-input-bindings.html#cb80-10"></a>    <span class="kw">let</span> isCollapsed <span class="op">=</span> <span class="at">$</span>(el).<span class="at">hasClass</span>(<span class="st">&#39;collapsed-box&#39;</span>)</span>
<span id="cb80-11"><a href="5-4-input-bindings.html#cb80-11"></a>    <span class="cf">return</span> <span class="op">{</span><span class="dt">collapsed</span><span class="op">:</span> isCollapsed<span class="op">};</span> <span class="co">// this will be a list in R</span></span>
<span id="cb80-12"><a href="5-4-input-bindings.html#cb80-12"></a>  <span class="op">},</span></span>
<span id="cb80-13"><a href="5-4-input-bindings.html#cb80-13"></a>  <span class="dt">setValue</span><span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> value) <span class="op">{</span></span>
<span id="cb80-14"><a href="5-4-input-bindings.html#cb80-14"></a>    <span class="at">$</span>(el).<span class="at">toggleBox</span>()<span class="op">;</span></span>
<span id="cb80-15"><a href="5-4-input-bindings.html#cb80-15"></a>  <span class="op">},</span> </span>
<span id="cb80-16"><a href="5-4-input-bindings.html#cb80-16"></a>  <span class="dt">receiveMessage</span><span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> data) <span class="op">{</span></span>
<span id="cb80-17"><a href="5-4-input-bindings.html#cb80-17"></a>    <span class="kw">this</span>.<span class="at">setValue</span>(el<span class="op">,</span> data)<span class="op">;</span></span>
<span id="cb80-18"><a href="5-4-input-bindings.html#cb80-18"></a>    <span class="at">$</span>(el).<span class="at">trigger</span>(<span class="st">&#39;change&#39;</span>)<span class="op">;</span></span>
<span id="cb80-19"><a href="5-4-input-bindings.html#cb80-19"></a>  <span class="op">},</span></span>
<span id="cb80-20"><a href="5-4-input-bindings.html#cb80-20"></a>  <span class="dt">subscribe</span><span class="op">:</span> <span class="kw">function</span>(el<span class="op">,</span> callback) <span class="op">{</span></span>
<span id="cb80-21"><a href="5-4-input-bindings.html#cb80-21"></a>    <span class="at">$</span>(el).<span class="at">on</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="st">&#39;[data-widget=&quot;collapse&quot;]&#39;</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></span>
<span id="cb80-22"><a href="5-4-input-bindings.html#cb80-22"></a>      <span class="at">setTimeout</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb80-23"><a href="5-4-input-bindings.html#cb80-23"></a>        <span class="at">callback</span>()<span class="op">;</span></span>
<span id="cb80-24"><a href="5-4-input-bindings.html#cb80-24"></a>      <span class="op">},</span> <span class="dv">550</span>)<span class="op">;</span></span>
<span id="cb80-25"><a href="5-4-input-bindings.html#cb80-25"></a>    <span class="op">}</span>)<span class="op">;</span> </span>
<span id="cb80-26"><a href="5-4-input-bindings.html#cb80-26"></a>    </span>
<span id="cb80-27"><a href="5-4-input-bindings.html#cb80-27"></a>    <span class="at">$</span>(el).<span class="at">on</span>(<span class="st">&#39;change&#39;</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></span>
<span id="cb80-28"><a href="5-4-input-bindings.html#cb80-28"></a>      <span class="at">setTimeout</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb80-29"><a href="5-4-input-bindings.html#cb80-29"></a>        <span class="at">callback</span>()<span class="op">;</span></span>
<span id="cb80-30"><a href="5-4-input-bindings.html#cb80-30"></a>      <span class="op">},</span> <span class="dv">550</span>)<span class="op">;</span></span>
<span id="cb80-31"><a href="5-4-input-bindings.html#cb80-31"></a>    <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb80-32"><a href="5-4-input-bindings.html#cb80-32"></a>  <span class="op">},</span></span>
<span id="cb80-33"><a href="5-4-input-bindings.html#cb80-33"></a>  <span class="dt">unsubscribe</span><span class="op">:</span> <span class="kw">function</span>(el) <span class="op">{</span></span>
<span id="cb80-34"><a href="5-4-input-bindings.html#cb80-34"></a>    <span class="at">$</span>(el).<span class="at">off</span>(<span class="st">&#39;.boxBinding&#39;</span>)<span class="op">;</span></span>
<span id="cb80-35"><a href="5-4-input-bindings.html#cb80-35"></a>  <span class="op">}</span></span>
<span id="cb80-36"><a href="5-4-input-bindings.html#cb80-36"></a><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb80-37"><a href="5-4-input-bindings.html#cb80-37"></a></span>
<span id="cb80-38"><a href="5-4-input-bindings.html#cb80-38"></a><span class="va">Shiny</span>.<span class="va">inputBindings</span>.<span class="at">register</span>(boxBinding<span class="op">,</span> <span class="st">&#39;box-input&#39;</span>)<span class="op">;</span></span></code></pre></div>
<p>Some comments about the binding:</p>
<ul>
<li><code>getValue</code> returns an object which will give a list in R. This is in case we add other elements like the remove action available in AdminLTE</li>
<li><code>setValue</code> calls the plug and play <code>toggleBox</code> method</li>
<li><code>receiveMessage</code> must trigger a change event so that Shiny knows when the value needs to be updated</li>
<li><code>subscribe</code> listens to the <code>click</code> event on the <code>[data-widget="collapse"]</code> element and delays the <code>callback</code> call by a value which is slightly higher than the default AdminLTE2 animation to collapse the box (500mx). If you omit this part, the input will not have time to properly update!!!</li>
<li>We don’t need an extra listener for the <code>updateBox2</code> function since it also triggers a click on the collapse button, thereby forwarding to the corresponding listener</li>
</ul>
<p>Let’s try our new toy in a simple dashboard:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="5-4-input-bindings.html#cb81-1"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb81-2"><a href="5-4-input-bindings.html#cb81-2"></a>  <span class="co"># import shinydashboard deps without the need of the dashboard template</span></span>
<span id="cb81-3"><a href="5-4-input-bindings.html#cb81-3"></a>  <span class="kw">useShinydashboard</span>(),</span>
<span id="cb81-4"><a href="5-4-input-bindings.html#cb81-4"></a></span>
<span id="cb81-5"><a href="5-4-input-bindings.html#cb81-5"></a>  tags<span class="op">$</span><span class="kw">style</span>(<span class="st">&quot;body { background-color: ghostwhite};&quot;</span>),</span>
<span id="cb81-6"><a href="5-4-input-bindings.html#cb81-6"></a></span>
<span id="cb81-7"><a href="5-4-input-bindings.html#cb81-7"></a>  <span class="kw">br</span>(),</span>
<span id="cb81-8"><a href="5-4-input-bindings.html#cb81-8"></a>  <span class="kw">box2</span>(</span>
<span id="cb81-9"><a href="5-4-input-bindings.html#cb81-9"></a>   <span class="dt">title =</span> <span class="kw">textOutput</span>(<span class="st">&quot;box_state&quot;</span>),</span>
<span id="cb81-10"><a href="5-4-input-bindings.html#cb81-10"></a>   <span class="st">&quot;Box body&quot;</span>,</span>
<span id="cb81-11"><a href="5-4-input-bindings.html#cb81-11"></a>   <span class="dt">inputId =</span> <span class="st">&quot;mybox&quot;</span>,</span>
<span id="cb81-12"><a href="5-4-input-bindings.html#cb81-12"></a>   <span class="dt">collapsible =</span> <span class="ot">TRUE</span>,</span>
<span id="cb81-13"><a href="5-4-input-bindings.html#cb81-13"></a>   <span class="kw">plotOutput</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb81-14"><a href="5-4-input-bindings.html#cb81-14"></a>  ),</span>
<span id="cb81-15"><a href="5-4-input-bindings.html#cb81-15"></a>  <span class="kw">actionButton</span>(<span class="st">&quot;toggle_box&quot;</span>, <span class="st">&quot;Toggle Box&quot;</span>, <span class="dt">class =</span> <span class="st">&quot;bg-success&quot;</span>)</span>
<span id="cb81-16"><a href="5-4-input-bindings.html#cb81-16"></a> )</span>
<span id="cb81-17"><a href="5-4-input-bindings.html#cb81-17"></a></span>
<span id="cb81-18"><a href="5-4-input-bindings.html#cb81-18"></a> server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</span>
<span id="cb81-19"><a href="5-4-input-bindings.html#cb81-19"></a>  output<span class="op">$</span>plot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</span>
<span id="cb81-20"><a href="5-4-input-bindings.html#cb81-20"></a>    <span class="kw">req</span>(<span class="op">!</span>input<span class="op">$</span>mybox<span class="op">$</span>collapsed)</span>
<span id="cb81-21"><a href="5-4-input-bindings.html#cb81-21"></a>    <span class="kw">plot</span>(<span class="kw">rnorm</span>(<span class="dv">200</span>))</span>
<span id="cb81-22"><a href="5-4-input-bindings.html#cb81-22"></a>  })</span>
<span id="cb81-23"><a href="5-4-input-bindings.html#cb81-23"></a></span>
<span id="cb81-24"><a href="5-4-input-bindings.html#cb81-24"></a>  output<span class="op">$</span>box_state &lt;-<span class="st"> </span><span class="kw">renderText</span>({</span>
<span id="cb81-25"><a href="5-4-input-bindings.html#cb81-25"></a>    state &lt;-<span class="st"> </span><span class="cf">if</span> (input<span class="op">$</span>mybox<span class="op">$</span>collapsed) <span class="st">&quot;collapsed&quot;</span> <span class="cf">else</span> <span class="st">&quot;uncollapsed&quot;</span></span>
<span id="cb81-26"><a href="5-4-input-bindings.html#cb81-26"></a>    <span class="kw">paste</span>(<span class="st">&quot;My box is&quot;</span>, state)</span>
<span id="cb81-27"><a href="5-4-input-bindings.html#cb81-27"></a>  })</span>
<span id="cb81-28"><a href="5-4-input-bindings.html#cb81-28"></a></span>
<span id="cb81-29"><a href="5-4-input-bindings.html#cb81-29"></a>  <span class="kw">observeEvent</span>(input<span class="op">$</span>toggle_box, {</span>
<span id="cb81-30"><a href="5-4-input-bindings.html#cb81-30"></a>    <span class="kw">updateBox2</span>(<span class="st">&quot;mybox&quot;</span>)</span>
<span id="cb81-31"><a href="5-4-input-bindings.html#cb81-31"></a>  })</span>
<span id="cb81-32"><a href="5-4-input-bindings.html#cb81-32"></a></span>
<span id="cb81-33"><a href="5-4-input-bindings.html#cb81-33"></a> }</span>
<span id="cb81-34"><a href="5-4-input-bindings.html#cb81-34"></a></span>
<span id="cb81-35"><a href="5-4-input-bindings.html#cb81-35"></a> <span class="kw">shinyApp</span>(ui, server)</span></code></pre></div>
</div>
</div>
<p style="text-align: center;">
<a href="5-3-initialization.html"><button class="btn btn-default">Previous</button></a>
<a href="5-5-utilities-to-quickly-define-new-inputs.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
