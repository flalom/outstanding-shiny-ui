<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="16.4 Tab events | Outstanding User Interfaces with Shiny" />
<meta property="og:type" content="book" />


<meta property="og:description" content="A book about deeply customizing Shiny app for production." />
<meta name="github-repo" content="DivadNojnarg/outstanding-shiny-ui" />

<meta name="author" content="David Granjon" />

<meta name="date" content="2020-08-31" />


<meta name="description" content="A book about deeply customizing Shiny app for production.">

<title>16.4 Tab events | Outstanding User Interfaces with Shiny</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
p.caption {
  color: #777;
  margin-top: 10px;
}
p code {
  white-space: inherit;
}
pre {
  word-break: normal;
  word-wrap: normal;
}
pre code {
  white-space: inherit;
}
p.flushright {
  text-align: right;
}
blockquote > p:last-child {
  text-align: right;
}
blockquote > p:first-child {
  text-align: inherit;
}

/* Callouts */
.callout {
  border-radius: 0.25rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
  background-color: #ffffff;
  border-left: 5px solid #e9ecef;
  margin-bottom: 1rem;
  padding: 1rem;
}

.callout a {
  color: #495057;
  text-decoration: underline;
}

.callout a:hover {
  color: #e9ecef;
}

.callout p:last-child {
  margin-bottom: 0;
}

.callout.callout-danger {
  border-left-color: #bd2130;
}

.callout.callout-warning {
  border-left-color: #d39e00;
}

.callout.callout-info {
  border-left-color: #117a8b;
}

.callout.callout-success {
  border-left-color: #1e7e34;
}


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#prerequisites">Prerequisites</a><ul>
<li><a href="disclaimer.html#disclaimer">Disclaimer</a></li>
<li><a href="is-this-book-for-me.html#is-this-book-for-me">Is this book for me?</a></li>
<li><a href="related-content.html#related-content">Related content</a></li>
<li><a href="acknowledgements.html#acknowledgements">Acknowledgements</a></li>
<li><a href="packages.html#packages">Packages</a></li>
</ul></li>
<li class="has-sub"><a href="1-intro.html#intro"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="1-1-about-the-code.html#about-the-code"><span class="toc-section-number">1.1</span> About the code</a></li>
<li><a href="1-2-preliminary-exercices.html#preliminary-exercices"><span class="toc-section-number">1.2</span> Preliminary exercices</a></li>
</ul></li>
<li class="part"><span><b>Survival Kit</b></span></li>
<li class="has-sub"><a href="2-survival-kit-html.html#survival-kit-html"><span class="toc-section-number">2</span> HTML</a><ul>
<li><a href="2-1-html-basics.html#html-basics"><span class="toc-section-number">2.1</span> HTML Basics</a></li>
<li><a href="2-2-tag-attributes.html#tag-attributes"><span class="toc-section-number">2.2</span> Tag attributes</a></li>
<li><a href="2-3-html-page-skeleton.html#html-page-skeleton"><span class="toc-section-number">2.3</span> HTML page: skeleton</a></li>
<li class="has-sub"><a href="2-4-about-the-document-object-model-dom.html#about-the-document-object-model-dom"><span class="toc-section-number">2.4</span> About the Document Object Model (DOM)</a><ul>
<li><a href="2-4-about-the-document-object-model-dom.html#visualizing-the-dom-the-html-inspector"><span class="toc-section-number">2.4.1</span> Visualizing the DOM: the HTML inspector</a></li>
</ul></li>
<li class="has-sub"><a href="2-5-preliminary-introduction-to-css-and-javascript.html#preliminary-introduction-to-css-and-javascript"><span class="toc-section-number">2.5</span> Preliminary introduction to CSS and JavaScript</a><ul>
<li><a href="2-5-preliminary-introduction-to-css-and-javascript.html#html-and-css"><span class="toc-section-number">2.5.1</span> HTML and CSS</a></li>
<li><a href="2-5-preliminary-introduction-to-css-and-javascript.html#html-and-javascript"><span class="toc-section-number">2.5.2</span> HTML and JavaScript</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="3-survival-kit-javascript.html#survival-kit-javascript"><span class="toc-section-number">3</span> JavaScript</a><ul>
<li><a href="3-1-introduction.html#introduction"><span class="toc-section-number">3.1</span> Introduction</a></li>
<li class="has-sub"><a href="3-2-setup.html#setup"><span class="toc-section-number">3.2</span> Setup</a><ul>
<li><a href="3-2-setup.html#node"><span class="toc-section-number">3.2.1</span> Node</a></li>
<li><a href="3-2-setup.html#choose-a-good-ide"><span class="toc-section-number">3.2.2</span> Choose a good IDE</a></li>
<li><a href="3-2-setup.html#first-script"><span class="toc-section-number">3.2.3</span> First Script</a></li>
</ul></li>
<li class="has-sub"><a href="3-3-programming-with-js-basis.html#programming-with-js-basis"><span class="toc-section-number">3.3</span> Programming with JS: basis</a><ul>
<li><a href="3-3-programming-with-js-basis.html#js-types"><span class="toc-section-number">3.3.1</span> JS types</a></li>
<li><a href="3-3-programming-with-js-basis.html#variables"><span class="toc-section-number">3.3.2</span> Variables</a></li>
<li><a href="3-3-programming-with-js-basis.html#conditions"><span class="toc-section-number">3.3.3</span> Conditions</a></li>
<li><a href="3-3-programming-with-js-basis.html#objects"><span class="toc-section-number">3.3.4</span> Objects</a></li>
<li><a href="3-3-programming-with-js-basis.html#iterations"><span class="toc-section-number">3.3.5</span> Iterations</a></li>
<li><a href="3-3-programming-with-js-basis.html#functions"><span class="toc-section-number">3.3.6</span> Functions</a></li>
<li><a href="3-3-programming-with-js-basis.html#event-listeners"><span class="toc-section-number">3.3.7</span> Event listeners</a></li>
</ul></li>
<li class="has-sub"><a href="3-4-jquery.html#jquery"><span class="toc-section-number">3.4</span> jQuery</a><ul>
<li><a href="3-4-jquery.html#introduction-1"><span class="toc-section-number">3.4.1</span> Introduction</a></li>
<li><a href="3-4-jquery.html#syntax"><span class="toc-section-number">3.4.2</span> Syntax</a></li>
<li><a href="3-4-jquery.html#useful-functions"><span class="toc-section-number">3.4.3</span> Useful functions</a></li>
<li><a href="3-4-jquery.html#chaining-jquery-methods"><span class="toc-section-number">3.4.4</span> Chaining jQuery methods</a></li>
<li><a href="3-4-jquery.html#iterations-1"><span class="toc-section-number">3.4.5</span> Iterations</a></li>
<li><a href="3-4-jquery.html#good-practice"><span class="toc-section-number">3.4.6</span> Good practice</a></li>
<li><a href="3-4-jquery.html#events"><span class="toc-section-number">3.4.7</span> Events</a></li>
<li><a href="3-4-jquery.html#extending-objects"><span class="toc-section-number">3.4.8</span> Extending objects</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Shiny: What’s under the Hood?</b></span></li>
<li class="has-sub"><a href="4-shiny-intro.html#shiny-intro"><span class="toc-section-number">4</span> Introduction</a><ul>
<li><a href="4-1-shiny-html-css-and-javascript.html#shiny-html-css-and-javascript"><span class="toc-section-number">4.1</span> Shiny, HTML, CSS and JavaScript</a></li>
<li><a href="4-2-shiny-websocket.html#shiny-websocket"><span class="toc-section-number">4.2</span> Websocket: R/JS bidirectional communication</a></li>
<li><a href="4-3-shiny-session.html#shiny-session"><span class="toc-section-number">4.3</span> The Shiny session object</a></li>
</ul></li>
<li class="has-sub"><a href="5-shiny-input-system.html#shiny-input-system"><span class="toc-section-number">5</span> Shiny’s input system</a><ul>
<li><a href="5-1-shiny-javascript-sources.html#shiny-javascript-sources"><span class="toc-section-number">5.1</span> Shiny JavaScript sources</a></li>
<li><a href="5-2-the-shiny-javascript-object.html#the-shiny-javascript-object"><span class="toc-section-number">5.2</span> The Shiny JavaScript object</a></li>
<li><a href="5-3-initialization.html#initialization"><span class="toc-section-number">5.3</span> Initialization</a></li>
<li class="has-sub"><a href="5-4-input-bindings.html#input-bindings"><span class="toc-section-number">5.4</span> Input bindings</a><ul>
<li><a href="5-4-input-bindings.html#input-structure"><span class="toc-section-number">5.4.1</span> Input structure</a></li>
<li><a href="5-4-input-bindings.html#binding-shiny-inputs"><span class="toc-section-number">5.4.2</span> Binding Shiny inputs</a></li>
<li><a href="5-4-input-bindings.html#binding-other-elements"><span class="toc-section-number">5.4.3</span> Binding other elements</a></li>
</ul></li>
<li class="has-sub"><a href="5-5-utilities-to-quickly-define-new-inputs.html#utilities-to-quickly-define-new-inputs"><span class="toc-section-number">5.5</span> Utilities to quickly define new inputs</a><ul>
<li><a href="3-1-introduction.html#introduction"><span class="toc-section-number">5.5.1</span> Introduction</a></li>
<li><a href="5-5-utilities-to-quickly-define-new-inputs.html#examples"><span class="toc-section-number">5.5.2</span> Examples</a></li>
<li><a href="5-5-utilities-to-quickly-define-new-inputs.html#custom-data-format"><span class="toc-section-number">5.5.3</span> Custom data format</a></li>
</ul></li>
<li class="has-sub"><a href="5-6-miscellaneous.html#miscellaneous"><span class="toc-section-number">5.6</span> Miscellaneous</a><ul>
<li><a href="5-6-miscellaneous.html#get-access-to-initial-values"><span class="toc-section-number">5.6.1</span> Get access to initial values</a></li>
</ul></li>
</ul></li>
<li><a href="6-shiny-custom-handler.html#shiny-custom-handler"><span class="toc-section-number">6</span> Custom handlers: from R to JavaScript</a></li>
<li class="part"><span><b>htmltools</b></span></li>
<li class="has-sub"><a href="7-htmltools-overview.html#htmltools-overview"><span class="toc-section-number">7</span> htmltools overview</a><ul>
<li><a href="7-1-html-tags.html#html-tags"><span class="toc-section-number">7.1</span> HTML Tags</a></li>
<li><a href="7-2-notations.html#notations"><span class="toc-section-number">7.2</span> Notations</a></li>
<li><a href="7-3-adding-new-tags.html#adding-new-tags"><span class="toc-section-number">7.3</span> Adding new tags</a></li>
<li><a href="7-4-alternative-way-to-write-tags.html#alternative-way-to-write-tags"><span class="toc-section-number">7.4</span> Alternative way to write tags</a></li>
<li class="has-sub"><a href="7-5-playing-with-tags.html#playing-with-tags"><span class="toc-section-number">7.5</span> Playing with tags</a><ul>
<li><a href="7-5-playing-with-tags.html#tags-structure"><span class="toc-section-number">7.5.1</span> Tags structure</a></li>
<li><a href="7-5-playing-with-tags.html#useful-functions-for-tags"><span class="toc-section-number">7.5.2</span> Useful functions for tags</a></li>
<li><a href="7-5-playing-with-tags.html#other-interesting-functions"><span class="toc-section-number">7.5.3</span> Other interesting functions</a></li>
<li><a href="7-5-playing-with-tags.html#conditionally-set-attributes"><span class="toc-section-number">7.5.4</span> Conditionally set attributes</a></li>
<li><a href="7-5-playing-with-tags.html#using"><span class="toc-section-number">7.5.5</span> Using %&gt;%</a></li>
<li><a href="7-5-playing-with-tags.html#programmatically-create-children-elements"><span class="toc-section-number">7.5.6</span> Programmatically create children elements</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="8-htmltools-dependencies.html#htmltools-dependencies"><span class="toc-section-number">8</span> Dependency utilities</a><ul>
<li><a href="8-1-the-dirty-approach.html#the-dirty-approach"><span class="toc-section-number">8.1</span> The dirty approach</a></li>
<li><a href="8-2-the-clean-approach.html#the-clean-approach"><span class="toc-section-number">8.2</span> The clean approach</a></li>
<li><a href="8-3-another-example-importing-html-dependencies-from-other-packages.html#another-example-importing-html-dependencies-from-other-packages"><span class="toc-section-number">8.3</span> Another example: Importing HTML dependencies from other packages</a></li>
<li><a href="8-4-suppress-dependencies.html#suppress-dependencies"><span class="toc-section-number">8.4</span> Suppress dependencies</a></li>
</ul></li>
<li class="has-sub"><a href="9-htmltools-other-tools.html#htmltools-other-tools"><span class="toc-section-number">9</span> Other tools</a><ul>
<li><a href="9-1-css.html#css"><span class="toc-section-number">9.1</span> CSS</a></li>
</ul></li>
<li class="part"><span><b>Practice 1: a dashboard template</b></span></li>
<li><a href="10-custom-templates-selection.html#custom-templates-selection"><span class="toc-section-number">10</span> Template selection</a></li>
<li class="has-sub"><a href="11-custom-templates-package.html#custom-templates-package"><span class="toc-section-number">11</span> Package creation</a><ul>
<li><a href="3-1-introduction.html#introduction"><span class="toc-section-number">11.1</span> Introduction</a></li>
<li><a href="11-2-step-by-step.html#step-by-step"><span class="toc-section-number">11.2</span> Step by step</a></li>
</ul></li>
<li class="has-sub"><a href="12-custom-templates-dependencies.html#custom-templates-dependencies"><span class="toc-section-number">12</span> Define dependencies</a><ul>
<li><a href="12-1-discover-the-project.html#discover-the-project"><span class="toc-section-number">12.1</span> Discover the project</a></li>
<li><a href="12-2-identify-mandatory-dependencies.html#identify-mandatory-dependencies"><span class="toc-section-number">12.2</span> Identify mandatory dependencies</a></li>
<li><a href="12-3-bundle-dependencies.html#bundle-dependencies"><span class="toc-section-number">12.3</span> Bundle dependencies</a></li>
</ul></li>
<li class="has-sub"><a href="13-custom-templates-skeleton.html#custom-templates-skeleton"><span class="toc-section-number">13</span> Template skeleton</a><ul>
<li><a href="13-1-identify-template-elements.html#identify-template-elements"><span class="toc-section-number">13.1</span> Identify template elements</a></li>
<li class="has-sub"><a href="13-2-design-the-page-layout.html#design-the-page-layout"><span class="toc-section-number">13.2</span> Design the page layout</a><ul>
<li><a href="13-2-design-the-page-layout.html#the-page-wrapper"><span class="toc-section-number">13.2.1</span> The page wrapper</a></li>
<li><a href="13-2-design-the-page-layout.html#the-body-content"><span class="toc-section-number">13.2.2</span> The body content</a></li>
<li><a href="13-2-design-the-page-layout.html#the-footer"><span class="toc-section-number">13.2.3</span> The footer</a></li>
<li><a href="13-2-design-the-page-layout.html#the-navbar-or-header"><span class="toc-section-number">13.2.4</span> The navbar (or header)</a></li>
<li><a href="13-2-design-the-page-layout.html#card-containers"><span class="toc-section-number">13.2.5</span> Card containers</a></li>
<li><a href="13-2-design-the-page-layout.html#ribbons-card-components"><span class="toc-section-number">13.2.6</span> Ribbons: card components</a></li>
<li><a href="13-2-design-the-page-layout.html#icons"><span class="toc-section-number">13.2.7</span> Icons</a></li>
</ul></li>
<li><a href="13-3-exercises.html#exercises"><span class="toc-section-number">13.3</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="14-custom-templates-testing.html#custom-templates-testing"><span class="toc-section-number">14</span> Testing and validating templates elements</a><ul>
<li class="has-sub"><a href="14-1-validate-template-functions.html#validate-template-functions"><span class="toc-section-number">14.1</span> Validate template functions</a><ul>
<li><a href="14-1-validate-template-functions.html#create-your-own-validations"><span class="toc-section-number">14.1.1</span> Create your own validations</a></li>
<li><a href="14-1-validate-template-functions.html#existing-utils-functions"><span class="toc-section-number">14.1.2</span> Existing utils functions</a></li>
<li><a href="14-1-validate-template-functions.html#example-refine-navbar-menu-items"><span class="toc-section-number">14.1.3</span> Example: refine navbar menu items</a></li>
</ul></li>
<li class="has-sub"><a href="14-2-testing-templates-elements.html#testing-templates-elements"><span class="toc-section-number">14.2</span> Testing templates elements</a><ul>
<li><a href="14-2-testing-templates-elements.html#testing-template-behavior"><span class="toc-section-number">14.2.1</span> Testing template behavior</a></li>
</ul></li>
<li><a href="14-3-testing-javascript.html#testing-javascript"><span class="toc-section-number">14.3</span> Testing JavaScript</a></li>
</ul></li>
<li class="has-sub"><a href="15-custom-templates-inputs.html#custom-templates-inputs"><span class="toc-section-number">15</span> Develop custom input widgets</a><ul>
<li class="has-sub"><a href="15-1-tabler-action-button.html#tabler-action-button"><span class="toc-section-number">15.1</span> Tabler action button</a><ul>
<li><a href="15-1-tabler-action-button.html#reminders-about-the-action-button"><span class="toc-section-number">15.1.1</span> Reminders about the action button</a></li>
<li><a href="15-1-tabler-action-button.html#application-to-tabler"><span class="toc-section-number">15.1.2</span> Application to Tabler</a></li>
</ul></li>
<li><a href="15-2-toggle-switch.html#toggle-switch"><span class="toc-section-number">15.2</span> Toggle Switch</a></li>
<li><a href="15-3-navbar-menu-input.html#navbar-menu-input"><span class="toc-section-number">15.3</span> Navbar menu input</a></li>
<li><a href="13-3-exercises.html#exercises"><span class="toc-section-number">15.4</span> Exercises</a></li>
</ul></li>
<li class="has-sub"><a href="16-custom-templates-interactivity.html#custom-templates-interactivity"><span class="toc-section-number">16</span> Adding more interactivity</a><ul>
<li><a href="16-1-custom-progress-bars.html#custom-progress-bars"><span class="toc-section-number">16.1</span> Custom progress bars</a></li>
<li class="has-sub"><a href="16-2-user-feedback-toasts.html#user-feedback-toasts"><span class="toc-section-number">16.2</span> User feedback: toasts</a><ul>
<li><a href="16-2-user-feedback-toasts.html#toast-skeleton"><span class="toc-section-number">16.2.1</span> Toast skeleton</a></li>
<li><a href="16-2-user-feedback-toasts.html#the-toast-api"><span class="toc-section-number">16.2.2</span> The toast API</a></li>
<li><a href="16-2-user-feedback-toasts.html#r-implementation"><span class="toc-section-number">16.2.3</span> R implementation</a></li>
<li><a href="16-2-user-feedback-toasts.html#wrap-up"><span class="toc-section-number">16.2.4</span> Wrap up</a></li>
</ul></li>
<li><a href="16-3-transform-an-element-in-a-custom-action-button.html#transform-an-element-in-a-custom-action-button"><span class="toc-section-number">16.3</span> Transform an element in a custom action button</a></li>
<li class="has-sub"><a href="16-4-tab-events.html#tab-events"><span class="toc-section-number">16.4</span> Tab events</a><ul>
<li><a href="16-4-tab-events.html#insert-tabs"><span class="toc-section-number">16.4.1</span> Insert/Remove tabs in tabsetpanel</a></li>
</ul></li>
<li><a href="13-3-exercises.html#exercises"><span class="toc-section-number">16.5</span> Exercises</a></li>
</ul></li>
<li class="part"><span><b>Beautify with CSS and SASS</b></span></li>
<li class="has-sub"><a href="17-beautify-with-fresh.html#beautify-with-fresh"><span class="toc-section-number">17</span> Beautify with fresh</a><ul>
<li><a href="17-1-fresh-the-big-picture.html#fresh-the-big-picture"><span class="toc-section-number">17.1</span> {fresh}, the big picture</a></li>
</ul></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="tab-events" class="section level2">
<h2><span class="header-section-number">16.4</span> Tab events</h2>
<p>Do you remember about the navbar element and the tabsetpanel system of Chapter <a href="13-custom-templates-skeleton.html#custom-templates-skeleton">13</a>? Navs allow to organize any app into several tabs, acting like pages. This is a powerful tool for Shiny since it is currently not straightforward to create <a href="https://community.rstudio.com/t/shiny-app-composed-of-many-many-pages/7698">multi-pages</a> Shiny apps like anyone would do with a website. Navs relie on the Bootstrap4 API but we only used few JS functions.</p>
<div id="insert-tabs" class="section level3">
<h3><span class="header-section-number">16.4.1</span> Insert/Remove tabs in tabsetpanel</h3>
<p>How about dynamically inserting/removing tabs from a <code>tabler_navbar</code>? I chose this example since it involves extra technical details about Shiny.</p>
<p>How do we proceed? if you remember about the <code>tabler_navbar_menu_item</code> and <code>tabler_tab_item</code> coupling, inserting a tab implies to insert the trigger in the navigation menu as well as the content in the dashboard body. Therefore, we need to know the structure of what we insert. Below is a reminder:</p>
<ul>
<li><code>tabler_navbar_menu_item</code> are <code>&lt;li&gt;</code> elements</li>
<li><code>tabler_navbar_menu_item</code> is a <code>&lt;div&gt;</code> element with specific classes</li>
</ul>
<div class="sourceCode" id="cb212"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb212-1"><a href="16-4-tab-events.html#cb212-1"></a><span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;nav-item&quot;</span><span class="kw">&gt;</span></span>
<span id="cb212-2"><a href="16-4-tab-events.html#cb212-2"></a>  <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;nav-link&quot;</span><span class="ot"> href=</span><span class="st">&quot;#ww&quot;</span><span class="ot"> data-toggle=</span><span class="st">&quot;pill&quot;</span><span class="ot"> data-value=</span><span class="st">&quot;ww&quot;</span><span class="ot"> role=</span><span class="st">&quot;tab&quot;</span><span class="kw">&gt;</span></span>
<span id="cb212-3"><a href="16-4-tab-events.html#cb212-3"></a>    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;nav-link-icon d-md-none d-lg-inline-block&quot;</span><span class="kw">&gt;&lt;/span&gt;</span></span>
<span id="cb212-4"><a href="16-4-tab-events.html#cb212-4"></a>    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;nav-link-title&quot;</span><span class="kw">&gt;</span>ww<span class="kw">&lt;/span&gt;</span></span>
<span id="cb212-5"><a href="16-4-tab-events.html#cb212-5"></a>  <span class="kw">&lt;/a&gt;</span></span>
<span id="cb212-6"><a href="16-4-tab-events.html#cb212-6"></a><span class="kw">&lt;/li&gt;</span></span>
<span id="cb212-7"><a href="16-4-tab-events.html#cb212-7"></a></span>
<span id="cb212-8"><a href="16-4-tab-events.html#cb212-8"></a><span class="kw">&lt;div</span><span class="ot"> role=</span><span class="st">&quot;tabpanel&quot;</span><span class="ot"> class=</span><span class="st">&quot;tab-pane fade container-fluid&quot;</span><span class="ot"> id=</span><span class="st">&quot;ww&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span></code></pre></div>
<p>We design the <code>insert_tabler_tab</code> function similar to the Shiny <code>insertTab</code>.
To handle shiny modules, we wrap the inputId in the session namespace <code>session$ns</code>. We create the menu item element based on the provided new tab.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="16-4-tab-events.html#cb213-1"></a>insert_tabler_tab &lt;-<span class="st"> </span><span class="cf">function</span>(inputId, tab, target, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>),</span>
<span id="cb213-2"><a href="16-4-tab-events.html#cb213-2"></a>                              <span class="dt">select =</span> <span class="ot">FALSE</span>, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()) {</span>
<span id="cb213-3"><a href="16-4-tab-events.html#cb213-3"></a>  </span>
<span id="cb213-4"><a href="16-4-tab-events.html#cb213-4"></a>  inputId &lt;-<span class="st"> </span>session<span class="op">$</span><span class="kw">ns</span>(inputId)</span>
<span id="cb213-5"><a href="16-4-tab-events.html#cb213-5"></a>  position &lt;-<span class="st"> </span><span class="kw">match.arg</span>(position)</span>
<span id="cb213-6"><a href="16-4-tab-events.html#cb213-6"></a>  navbar_menu_item &lt;-<span class="st"> </span>tags<span class="op">$</span><span class="kw">li</span>(</span>
<span id="cb213-7"><a href="16-4-tab-events.html#cb213-7"></a>    <span class="dt">class =</span> <span class="st">&quot;nav-item&quot;</span>,</span>
<span id="cb213-8"><a href="16-4-tab-events.html#cb213-8"></a>    <span class="kw">a</span>(</span>
<span id="cb213-9"><a href="16-4-tab-events.html#cb213-9"></a>      <span class="dt">class =</span> <span class="st">&quot;nav-link&quot;</span>,</span>
<span id="cb213-10"><a href="16-4-tab-events.html#cb213-10"></a>      <span class="dt">href =</span> <span class="kw">paste0</span>(<span class="st">&quot;#&quot;</span>, session<span class="op">$</span><span class="kw">ns</span>(tab<span class="op">$</span>attribs<span class="op">$</span>id)),</span>
<span id="cb213-11"><a href="16-4-tab-events.html#cb213-11"></a>      <span class="st">`</span><span class="dt">data-toggle</span><span class="st">`</span> =<span class="st"> &quot;pill&quot;</span>,</span>
<span id="cb213-12"><a href="16-4-tab-events.html#cb213-12"></a>      <span class="st">`</span><span class="dt">data-value</span><span class="st">`</span> =<span class="st"> </span>tab<span class="op">$</span>attribs<span class="op">$</span>id,</span>
<span id="cb213-13"><a href="16-4-tab-events.html#cb213-13"></a>      <span class="dt">role =</span> <span class="st">&quot;tab&quot;</span>,</span>
<span id="cb213-14"><a href="16-4-tab-events.html#cb213-14"></a>      tab<span class="op">$</span>attribs<span class="op">$</span>id</span>
<span id="cb213-15"><a href="16-4-tab-events.html#cb213-15"></a>    )</span>
<span id="cb213-16"><a href="16-4-tab-events.html#cb213-16"></a>  )</span>
<span id="cb213-17"><a href="16-4-tab-events.html#cb213-17"></a>  </span>
<span id="cb213-18"><a href="16-4-tab-events.html#cb213-18"></a>  tab &lt;-<span class="st"> </span><span class="kw">force</span>(<span class="kw">as.character</span>(tab))</span>
<span id="cb213-19"><a href="16-4-tab-events.html#cb213-19"></a>  navbar_menu_item &lt;-<span class="st"> </span><span class="kw">force</span>(<span class="kw">as.character</span>(navbar_menu_item))</span>
<span id="cb213-20"><a href="16-4-tab-events.html#cb213-20"></a>  </span>
<span id="cb213-21"><a href="16-4-tab-events.html#cb213-21"></a>  message &lt;-<span class="st"> </span><span class="kw">dropNulls</span>(</span>
<span id="cb213-22"><a href="16-4-tab-events.html#cb213-22"></a>    <span class="kw">list</span>(</span>
<span id="cb213-23"><a href="16-4-tab-events.html#cb213-23"></a>      <span class="dt">inputId =</span> inputId,</span>
<span id="cb213-24"><a href="16-4-tab-events.html#cb213-24"></a>      <span class="dt">content =</span> tab,</span>
<span id="cb213-25"><a href="16-4-tab-events.html#cb213-25"></a>      <span class="dt">link =</span> navbar_menu_item,</span>
<span id="cb213-26"><a href="16-4-tab-events.html#cb213-26"></a>      <span class="dt">target =</span> target,</span>
<span id="cb213-27"><a href="16-4-tab-events.html#cb213-27"></a>      <span class="dt">position =</span> position,</span>
<span id="cb213-28"><a href="16-4-tab-events.html#cb213-28"></a>      <span class="dt">select =</span> select</span>
<span id="cb213-29"><a href="16-4-tab-events.html#cb213-29"></a>    )</span>
<span id="cb213-30"><a href="16-4-tab-events.html#cb213-30"></a>  )</span>
<span id="cb213-31"><a href="16-4-tab-events.html#cb213-31"></a>  session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="dt">type =</span> <span class="st">&quot;insert-tab&quot;</span>, message)</span>
<span id="cb213-32"><a href="16-4-tab-events.html#cb213-32"></a>}</span></code></pre></div>
<p>On the JS side, we capture the R message (list) in two elements:</p>
<ul>
<li><code>$divTag</code> contains the tab content</li>
<li><code>$liTag</code> contains the tab link, ie the navigation part</li>
</ul>
<p>Depending on the position parameter, we use the <code>insertAfter</code> and <code>insertBefore</code> jQuery methods. Finally, if the newly inserted tab has to be
selected, we activate the corresponding tab element with <code>$(tablink).tab('show')</code>.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb214-1"><a href="16-4-tab-events.html#cb214-1"></a><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb214-2"><a href="16-4-tab-events.html#cb214-2"></a>  <span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;insert-tab&#39;</span><span class="op">,</span> <span class="kw">function</span>(message) <span class="op">{</span></span>
<span id="cb214-3"><a href="16-4-tab-events.html#cb214-3"></a>    <span class="co">// define div and li targets</span></span>
<span id="cb214-4"><a href="16-4-tab-events.html#cb214-4"></a>    <span class="kw">let</span> $divTag <span class="op">=</span> <span class="at">$</span>(<span class="va">message</span>.<span class="at">content</span>)<span class="op">;</span></span>
<span id="cb214-5"><a href="16-4-tab-events.html#cb214-5"></a>    <span class="kw">let</span> $liTag <span class="op">=</span> <span class="at">$</span>(<span class="va">message</span>.<span class="at">link</span>)<span class="op">;</span></span>
<span id="cb214-6"><a href="16-4-tab-events.html#cb214-6"></a>    </span>
<span id="cb214-7"><a href="16-4-tab-events.html#cb214-7"></a>    <span class="cf">if</span> (<span class="va">message</span>.<span class="at">position</span> <span class="op">===</span> <span class="st">&#39;after&#39;</span>) <span class="op">{</span></span>
<span id="cb214-8"><a href="16-4-tab-events.html#cb214-8"></a>      <span class="va">$divTag</span>.<span class="at">insertAfter</span>(<span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span>))<span class="op">;</span></span>
<span id="cb214-9"><a href="16-4-tab-events.html#cb214-9"></a>      <span class="va">$liTag</span>.<span class="at">insertAfter</span>(<span class="at">$</span>(<span class="st">&#39;[href =&quot;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span> <span class="op">+</span> <span class="st">&#39;&quot;]&#39;</span>).<span class="at">parent</span>())<span class="op">;</span></span>
<span id="cb214-10"><a href="16-4-tab-events.html#cb214-10"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> (<span class="va">message</span>.<span class="at">position</span> <span class="op">===</span> <span class="st">&#39;before&#39;</span>) <span class="op">{</span></span>
<span id="cb214-11"><a href="16-4-tab-events.html#cb214-11"></a>      <span class="va">$divTag</span>.<span class="at">insertBefore</span>(<span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span>))<span class="op">;</span></span>
<span id="cb214-12"><a href="16-4-tab-events.html#cb214-12"></a>      <span class="va">$liTag</span>.<span class="at">insertBefore</span>(<span class="at">$</span>(<span class="st">&#39;[href =&quot;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span> <span class="op">+</span> <span class="st">&#39;&quot;]&#39;</span>).<span class="at">parent</span>())<span class="op">;</span></span>
<span id="cb214-13"><a href="16-4-tab-events.html#cb214-13"></a>    <span class="op">}</span></span>
<span id="cb214-14"><a href="16-4-tab-events.html#cb214-14"></a>    </span>
<span id="cb214-15"><a href="16-4-tab-events.html#cb214-15"></a>    <span class="cf">if</span> (<span class="va">message</span>.<span class="at">select</span>) <span class="op">{</span></span>
<span id="cb214-16"><a href="16-4-tab-events.html#cb214-16"></a>    <span class="co">// trigger a click on corresponding the new tab button. </span></span>
<span id="cb214-17"><a href="16-4-tab-events.html#cb214-17"></a>      <span class="kw">let</span> newTabId <span class="op">=</span> <span class="va">$divTag</span>.<span class="at">attr</span>(<span class="st">&#39;id&#39;</span>)<span class="op">;</span></span>
<span id="cb214-18"><a href="16-4-tab-events.html#cb214-18"></a>      <span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">inputId</span> <span class="op">+</span> <span class="st">&#39; a[href=&quot;#&#39;</span> <span class="op">+</span> newTabId <span class="op">+</span><span class="st">&#39;&quot;]&#39;</span>).<span class="at">tab</span>(<span class="st">&#39;show&#39;</span>)<span class="op">;</span></span>
<span id="cb214-19"><a href="16-4-tab-events.html#cb214-19"></a>    <span class="op">}</span></span>
<span id="cb214-20"><a href="16-4-tab-events.html#cb214-20"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb214-21"><a href="16-4-tab-events.html#cb214-21"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="16-4-tab-events.html#cb215-1"></a><span class="kw">insert_tabler_tab_example</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>If the tab is well inserted, we notice that the slider and the plot are not properly shown, as illustrated in Figure <a href="16-4-tab-events.html#fig:tabler-insert-tab-fail">16.4</a>.</p>
<div class="figure"><span id="fig:tabler-insert-tab-fail"></span>
<img src="images/practice/tabler-insert-tab-fail.png" alt="The newly inserted tab fails to render its content!" width="540" />
<p class="caption">
FIGURE 16.4: The newly inserted tab fails to render its content!
</p>
</div>
<p>How could we explain that? It is a dependency issue: the slider input relies on a specific JS <a href="http://ionden.com/a/plugins/ion.rangeSlider/">library</a>, namely ionRangesSlider, as depicted in Figure <a href="16-4-tab-events.html#fig:slider-deps">16.5</a>. In our previous example, if you open the HTML inspector, the dependency is not included in the page.</p>
<div class="figure"><span id="fig:slider-deps"></span>
<img src="images/practice/slider-deps.png" alt="Slider dependencies." width="1297" />
<p class="caption">
FIGURE 16.5: Slider dependencies.
</p>
</div>
<p>Even stranger, when we use <code>renderUI</code> to conditionally render the slider (note: this is a dummy example), the dependency is only included when the go button is pressed. How does Shiny includes them?</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="16-4-tab-events.html#cb216-1"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb216-2"><a href="16-4-tab-events.html#cb216-2"></a>  shiny<span class="op">::</span><span class="kw">actionButton</span>(<span class="st">&quot;go&quot;</span>, <span class="st">&quot;Go!&quot;</span>, <span class="dt">class =</span> <span class="st">&quot;btn-success&quot;</span>),</span>
<span id="cb216-3"><a href="16-4-tab-events.html#cb216-3"></a>  <span class="kw">uiOutput</span>(<span class="st">&quot;slider&quot;</span>),</span>
<span id="cb216-4"><a href="16-4-tab-events.html#cb216-4"></a>  <span class="kw">plotOutput</span>(<span class="st">&quot;distPlot&quot;</span>)</span>
<span id="cb216-5"><a href="16-4-tab-events.html#cb216-5"></a>)</span>
<span id="cb216-6"><a href="16-4-tab-events.html#cb216-6"></a></span>
<span id="cb216-7"><a href="16-4-tab-events.html#cb216-7"></a><span class="co"># Server logic</span></span>
<span id="cb216-8"><a href="16-4-tab-events.html#cb216-8"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output) {</span>
<span id="cb216-9"><a href="16-4-tab-events.html#cb216-9"></a>  </span>
<span id="cb216-10"><a href="16-4-tab-events.html#cb216-10"></a>  output<span class="op">$</span>slider &lt;-<span class="st"> </span><span class="kw">renderUI</span>({</span>
<span id="cb216-11"><a href="16-4-tab-events.html#cb216-11"></a>    <span class="kw">req</span>(input<span class="op">$</span>go <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb216-12"><a href="16-4-tab-events.html#cb216-12"></a>    <span class="kw">sliderInput</span>(</span>
<span id="cb216-13"><a href="16-4-tab-events.html#cb216-13"></a>      <span class="st">&quot;obs&quot;</span>, </span>
<span id="cb216-14"><a href="16-4-tab-events.html#cb216-14"></a>      <span class="st">&quot;Number of observations:&quot;</span>,</span>
<span id="cb216-15"><a href="16-4-tab-events.html#cb216-15"></a>      <span class="dt">min =</span> <span class="dv">0</span>, </span>
<span id="cb216-16"><a href="16-4-tab-events.html#cb216-16"></a>      <span class="dt">max =</span> <span class="dv">1000</span>, </span>
<span id="cb216-17"><a href="16-4-tab-events.html#cb216-17"></a>      <span class="dt">value =</span> <span class="dv">500</span></span>
<span id="cb216-18"><a href="16-4-tab-events.html#cb216-18"></a>    )</span>
<span id="cb216-19"><a href="16-4-tab-events.html#cb216-19"></a>  })</span>
<span id="cb216-20"><a href="16-4-tab-events.html#cb216-20"></a>  </span>
<span id="cb216-21"><a href="16-4-tab-events.html#cb216-21"></a>  output<span class="op">$</span>distPlot &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</span>
<span id="cb216-22"><a href="16-4-tab-events.html#cb216-22"></a>    <span class="kw">req</span>(input<span class="op">$</span>obs)</span>
<span id="cb216-23"><a href="16-4-tab-events.html#cb216-23"></a>    <span class="kw">hist</span>(<span class="kw">rnorm</span>(input<span class="op">$</span>obs))</span>
<span id="cb216-24"><a href="16-4-tab-events.html#cb216-24"></a>  })</span>
<span id="cb216-25"><a href="16-4-tab-events.html#cb216-25"></a>}</span>
<span id="cb216-26"><a href="16-4-tab-events.html#cb216-26"></a></span>
<span id="cb216-27"><a href="16-4-tab-events.html#cb216-27"></a><span class="co"># Complete app with UI and server components</span></span>
<span id="cb216-28"><a href="16-4-tab-events.html#cb216-28"></a><span class="kw">shinyApp</span>(ui, server)</span></code></pre></div>
<p>Let’s look at <code>renderUI</code>:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="16-4-tab-events.html#cb217-1"></a>renderUI &lt;-<span class="st"> </span><span class="cf">function</span> (expr, <span class="dt">env =</span> <span class="kw">parent.frame</span>(), <span class="dt">quoted =</span> <span class="ot">FALSE</span>, <span class="dt">outputArgs =</span> <span class="kw">list</span>()) {</span>
<span id="cb217-2"><a href="16-4-tab-events.html#cb217-2"></a>    <span class="kw">installExprFunction</span>(expr, <span class="st">&quot;func&quot;</span>, env, quoted)</span>
<span id="cb217-3"><a href="16-4-tab-events.html#cb217-3"></a>    <span class="kw">createRenderFunction</span>(func, <span class="cf">function</span>(result, shinysession, </span>
<span id="cb217-4"><a href="16-4-tab-events.html#cb217-4"></a>        name, ...) {</span>
<span id="cb217-5"><a href="16-4-tab-events.html#cb217-5"></a>        <span class="cf">if</span> (<span class="kw">is.null</span>(result) <span class="op">||</span><span class="st"> </span><span class="kw">length</span>(result) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </span>
<span id="cb217-6"><a href="16-4-tab-events.html#cb217-6"></a>            <span class="kw">return</span>(<span class="ot">NULL</span>)</span>
<span id="cb217-7"><a href="16-4-tab-events.html#cb217-7"></a>        <span class="co">#processDeps(result, shinysession)</span></span>
<span id="cb217-8"><a href="16-4-tab-events.html#cb217-8"></a>      result</span>
<span id="cb217-9"><a href="16-4-tab-events.html#cb217-9"></a>    }, uiOutput, outputArgs)</span>
<span id="cb217-10"><a href="16-4-tab-events.html#cb217-10"></a>}</span></code></pre></div>
<p>The last line returned is <code>processDeps(result, shinysession)</code>. This function is responsible to handle dependencies during runtime. <code>processDeps</code> (R side) works with <code>Shiny.renderContent</code> (JS side). The latter takes a tag element as well as an object containing its HTML code and dependencies, for instance:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb218-1"><a href="16-4-tab-events.html#cb218-1"></a><span class="va">exports</span>.<span class="at">renderContent</span>($tag[<span class="dv">0</span>]<span class="op">,</span> <span class="op">{</span></span>
<span id="cb218-2"><a href="16-4-tab-events.html#cb218-2"></a>  <span class="dt">html</span><span class="op">:</span> <span class="va">$tag</span>.<span class="at">html</span>()<span class="op">,</span></span>
<span id="cb218-3"><a href="16-4-tab-events.html#cb218-3"></a>  <span class="dt">deps</span><span class="op">:</span> <span class="va">message</span>.<span class="va">tag</span>.<span class="at">deps</span></span>
<span id="cb218-4"><a href="16-4-tab-events.html#cb218-4"></a><span class="op">}</span>)<span class="op">;</span> </span></code></pre></div>
<p>In the following, we modify the <code>insert_tabler_tab</code> to include the dependencies processing step.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="16-4-tab-events.html#cb219-1"></a>insert_tabler_tab &lt;-<span class="st"> </span><span class="cf">function</span>(inputId, tab, target, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;before&quot;</span>, <span class="st">&quot;after&quot;</span>),</span>
<span id="cb219-2"><a href="16-4-tab-events.html#cb219-2"></a>                              <span class="dt">select =</span> <span class="ot">FALSE</span>, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()) {</span>
<span id="cb219-3"><a href="16-4-tab-events.html#cb219-3"></a>  </span>
<span id="cb219-4"><a href="16-4-tab-events.html#cb219-4"></a>  inputId &lt;-<span class="st"> </span>session<span class="op">$</span><span class="kw">ns</span>(inputId)</span>
<span id="cb219-5"><a href="16-4-tab-events.html#cb219-5"></a>  position &lt;-<span class="st"> </span><span class="kw">match.arg</span>(position)</span>
<span id="cb219-6"><a href="16-4-tab-events.html#cb219-6"></a>  navbar_menu_item &lt;-<span class="st"> </span>tags<span class="op">$</span><span class="kw">li</span>(</span>
<span id="cb219-7"><a href="16-4-tab-events.html#cb219-7"></a>    <span class="dt">class =</span> <span class="st">&quot;nav-item&quot;</span>,</span>
<span id="cb219-8"><a href="16-4-tab-events.html#cb219-8"></a>    <span class="kw">a</span>(</span>
<span id="cb219-9"><a href="16-4-tab-events.html#cb219-9"></a>      <span class="dt">class =</span> <span class="st">&quot;nav-link&quot;</span>,</span>
<span id="cb219-10"><a href="16-4-tab-events.html#cb219-10"></a>      <span class="dt">href =</span> <span class="kw">paste0</span>(<span class="st">&quot;#&quot;</span>, session<span class="op">$</span><span class="kw">ns</span>(tab<span class="op">$</span>attribs<span class="op">$</span>id)),</span>
<span id="cb219-11"><a href="16-4-tab-events.html#cb219-11"></a>      <span class="st">`</span><span class="dt">data-toggle</span><span class="st">`</span> =<span class="st"> &quot;pill&quot;</span>,</span>
<span id="cb219-12"><a href="16-4-tab-events.html#cb219-12"></a>      <span class="st">`</span><span class="dt">data-value</span><span class="st">`</span> =<span class="st"> </span>tab<span class="op">$</span>attribs<span class="op">$</span>id,</span>
<span id="cb219-13"><a href="16-4-tab-events.html#cb219-13"></a>      <span class="dt">role =</span> <span class="st">&quot;tab&quot;</span>,</span>
<span id="cb219-14"><a href="16-4-tab-events.html#cb219-14"></a>      tab<span class="op">$</span>attribs<span class="op">$</span>id</span>
<span id="cb219-15"><a href="16-4-tab-events.html#cb219-15"></a>    )</span>
<span id="cb219-16"><a href="16-4-tab-events.html#cb219-16"></a>  )</span>
<span id="cb219-17"><a href="16-4-tab-events.html#cb219-17"></a>  </span>
<span id="cb219-18"><a href="16-4-tab-events.html#cb219-18"></a>  message &lt;-<span class="st"> </span><span class="kw">dropNulls</span>(</span>
<span id="cb219-19"><a href="16-4-tab-events.html#cb219-19"></a>    <span class="kw">list</span>(</span>
<span id="cb219-20"><a href="16-4-tab-events.html#cb219-20"></a>      <span class="dt">inputId =</span> inputId,</span>
<span id="cb219-21"><a href="16-4-tab-events.html#cb219-21"></a>      <span class="dt">content =</span> <span class="kw">processDeps</span>(tab, session),</span>
<span id="cb219-22"><a href="16-4-tab-events.html#cb219-22"></a>      <span class="dt">link =</span> <span class="kw">processDeps</span>(navbar_menu_item, session),</span>
<span id="cb219-23"><a href="16-4-tab-events.html#cb219-23"></a>      <span class="dt">target =</span> target,</span>
<span id="cb219-24"><a href="16-4-tab-events.html#cb219-24"></a>      <span class="dt">position =</span> position,</span>
<span id="cb219-25"><a href="16-4-tab-events.html#cb219-25"></a>      <span class="dt">select =</span> select</span>
<span id="cb219-26"><a href="16-4-tab-events.html#cb219-26"></a>    )</span>
<span id="cb219-27"><a href="16-4-tab-events.html#cb219-27"></a>  )</span>
<span id="cb219-28"><a href="16-4-tab-events.html#cb219-28"></a>  session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="dt">type =</span> <span class="st">&quot;insert-tab&quot;</span>, message)</span>
<span id="cb219-29"><a href="16-4-tab-events.html#cb219-29"></a>}</span></code></pre></div>
<p>We then apply the <code>Shiny.renderContent</code> method to the tab content and navigation item.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb220-1"><a href="16-4-tab-events.html#cb220-1"></a><span class="at">$</span>(<span class="kw">function</span>() <span class="op">{</span></span>
<span id="cb220-2"><a href="16-4-tab-events.html#cb220-2"></a>  <span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;insert-tab&#39;</span><span class="op">,</span> <span class="kw">function</span>(message) <span class="op">{</span></span>
<span id="cb220-3"><a href="16-4-tab-events.html#cb220-3"></a>  <span class="co">// define div and li targets</span></span>
<span id="cb220-4"><a href="16-4-tab-events.html#cb220-4"></a>    <span class="kw">let</span> $divTag <span class="op">=</span> <span class="at">$</span>(<span class="va">message</span>.<span class="va">content</span>.<span class="at">html</span>)<span class="op">;</span></span>
<span id="cb220-5"><a href="16-4-tab-events.html#cb220-5"></a>    <span class="kw">let</span> $liTag <span class="op">=</span> <span class="at">$</span>(<span class="va">message</span>.<span class="va">link</span>.<span class="at">html</span>)<span class="op">;</span></span>
<span id="cb220-6"><a href="16-4-tab-events.html#cb220-6"></a>    </span>
<span id="cb220-7"><a href="16-4-tab-events.html#cb220-7"></a>    <span class="cf">if</span> (<span class="va">message</span>.<span class="at">position</span> <span class="op">===</span> <span class="st">&#39;after&#39;</span>) <span class="op">{</span></span>
<span id="cb220-8"><a href="16-4-tab-events.html#cb220-8"></a>      <span class="va">$divTag</span>.<span class="at">insertAfter</span>(<span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span>))<span class="op">;</span></span>
<span id="cb220-9"><a href="16-4-tab-events.html#cb220-9"></a>      <span class="va">$liTag</span>.<span class="at">insertAfter</span>(<span class="at">$</span>(<span class="st">&#39;[href =&quot;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span> <span class="op">+</span>   <span class="st">&#39;&quot;]&#39;</span>).<span class="at">parent</span>())<span class="op">;</span></span>
<span id="cb220-10"><a href="16-4-tab-events.html#cb220-10"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> (<span class="va">message</span>.<span class="at">position</span> <span class="op">===</span> <span class="st">&#39;before&#39;</span>) <span class="op">{</span></span>
<span id="cb220-11"><a href="16-4-tab-events.html#cb220-11"></a>      <span class="va">$divTag</span>.<span class="at">insertBefore</span>(<span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span>))<span class="op">;</span></span>
<span id="cb220-12"><a href="16-4-tab-events.html#cb220-12"></a>      <span class="va">$liTag</span>.<span class="at">insertBefore</span>(<span class="at">$</span>(<span class="st">&#39;[href =&quot;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">target</span> <span class="op">+</span>   <span class="st">&#39;&quot;]&#39;</span>).<span class="at">parent</span>())<span class="op">;</span></span>
<span id="cb220-13"><a href="16-4-tab-events.html#cb220-13"></a>    <span class="op">}</span></span>
<span id="cb220-14"><a href="16-4-tab-events.html#cb220-14"></a>  </span>
<span id="cb220-15"><a href="16-4-tab-events.html#cb220-15"></a>      <span class="co">// needed to render input/output in newly added tab. It takes the possible</span></span>
<span id="cb220-16"><a href="16-4-tab-events.html#cb220-16"></a>      <span class="co">// deps and add them to the tag. Indeed, if we insert a tab, its deps are not</span></span>
<span id="cb220-17"><a href="16-4-tab-events.html#cb220-17"></a>      <span class="co">// included in the page so it can&#39;t render properly</span></span>
<span id="cb220-18"><a href="16-4-tab-events.html#cb220-18"></a>      <span class="va">Shiny</span>.<span class="at">renderContent</span>($liTag[<span class="dv">0</span>]<span class="op">,</span> <span class="op">{</span><span class="dt">html</span><span class="op">:</span> <span class="va">$liTag</span>.<span class="at">html</span>()<span class="op">,</span> <span class="dt">deps</span><span class="op">:</span> <span class="va">message</span>.<span class="va">link</span>.<span class="at">deps</span><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb220-19"><a href="16-4-tab-events.html#cb220-19"></a>      <span class="va">Shiny</span>.<span class="at">renderContent</span>($divTag[<span class="dv">0</span>]<span class="op">,</span> <span class="op">{</span><span class="dt">html</span><span class="op">:</span> <span class="va">$divTag</span>.<span class="at">html</span>()<span class="op">,</span> <span class="dt">deps</span><span class="op">:</span> <span class="va">message</span>.<span class="va">content</span>.<span class="at">deps</span><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb220-20"><a href="16-4-tab-events.html#cb220-20"></a>    </span>
<span id="cb220-21"><a href="16-4-tab-events.html#cb220-21"></a>    <span class="cf">if</span> (<span class="va">message</span>.<span class="at">select</span>) <span class="op">{</span></span>
<span id="cb220-22"><a href="16-4-tab-events.html#cb220-22"></a>    <span class="co">// trigger a click on corresponding the new tab button. </span></span>
<span id="cb220-23"><a href="16-4-tab-events.html#cb220-23"></a>    <span class="kw">let</span> newTabId <span class="op">=</span> <span class="va">$divTag</span>.<span class="at">attr</span>(<span class="st">&#39;id&#39;</span>)<span class="op">;</span></span>
<span id="cb220-24"><a href="16-4-tab-events.html#cb220-24"></a>      <span class="at">$</span>(<span class="st">&#39;#&#39;</span> <span class="op">+</span> <span class="va">message</span>.<span class="at">inputId</span> <span class="op">+</span> <span class="st">&#39; a[href=&quot;#&#39;</span> <span class="op">+</span> newTabId   <span class="op">+</span><span class="st">&#39;&quot;]&#39;</span>).<span class="at">tab</span>(<span class="st">&#39;show&#39;</span>)<span class="op">;</span></span>
<span id="cb220-25"><a href="16-4-tab-events.html#cb220-25"></a>    <span class="op">}</span></span>
<span id="cb220-26"><a href="16-4-tab-events.html#cb220-26"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb220-27"><a href="16-4-tab-events.html#cb220-27"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>We check if our approach works as expected.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="16-4-tab-events.html#cb221-1"></a><span class="kw">insert_tabler_tab_example</span>(<span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:process-deps"></span>
<img src="images/practice/process-deps.png" alt="processDeps and Shiny.renderContent in action." width="1297" />
<p class="caption">
FIGURE 16.6: processDeps and Shiny.renderContent in action.
</p>
</div>
<p>Et voila! As shown in Figure <a href="16-4-tab-events.html#fig:process-deps">16.6</a>, everything is properly displayed.</p>
</div>
</div>
<p style="text-align: center;">
<a href="16-3-transform-an-element-in-a-custom-action-button.html"><button class="btn btn-default">Previous</button></a>
<a href="16-5-exercises.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
